!function(t){t.VCO={VERSION:"0.1",_originalL:t.VCO}}(this),VCO.debug=!0,VCO.Bind=function(t,e){return function(){return t.apply(e,arguments)}},trace=function(t){VCO.debug&&(window.console?console.log(t):"undefined"!=typeof jsTrace&&jsTrace.send(t))},VCO.Util={extend:function(t){for(var e=Array.prototype.slice.call(arguments,1),i=0,n=e.length,a;n>i;i++){a=e[i]||{};for(var s in a)a.hasOwnProperty(s)&&(t[s]=a[s])}return t},setOptions:function(t,e){t.options=VCO.Util.extend({},t.options,e),""===t.options.uniqueid&&(t.options.uniqueid=VCO.Util.unique_ID(6))},isEven:function(t){return t==parseFloat(t)?!(t%2):void 0},findArrayNumberByUniqueID:function(t,e,i){for(var n=0,a=0;a<e.length;a++)e[a].data[i]==t&&(n=a);return n},convertUnixTime:function(t){var e,i,n,a,s,o,r=[],h={ymd:"",time:"",time_array:[],date_array:[],full_array:[]};h.ymd=t.split(" ")[0],h.time=t.split(" ")[1],h.date_array=h.ymd.split("-"),h.time_array=h.time.split(":"),h.full_array=h.date_array.concat(h.time_array);for(var l=0;l<h.full_array.length;l++)r.push(parseInt(h.full_array[l]));return e=new Date(r[0],r[1],r[2],r[3],r[4],r[5]),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=e.getFullYear(),a=i[e.getMonth()],s=e.getDate(),o=a+", "+s+" "+n},setData:function(t,e){t.data=VCO.Util.extend({},t.data,e),""===t.data.uniqueid&&(t.data.uniqueid=VCO.Util.unique_ID(6))},mergeData:function(t,e){var i;for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},stamp:function(){var t=0,e="_vco_id";return function(i){return i[e]=i[e]||++t,i[e]}}(),isArray:function(){if(Array.isArray)return Array.isArray;var t=Object.prototype.toString,e=t.call([]);return function(i){return t.call(i)===e}}(),getRandomNumber:function(t){return Math.floor(Math.random()*t)},unique_ID:function(t,e){var i=function(t){return Math.floor(Math.random()*t)},n=function(){var t="abcdefghijklmnopqurstuvwxyz";return t.substr(i(32),1)},a=function(t){for(var e="",i=0;t>i;i++)e+=n();return e};return e?e+"-"+a(t):"vco-"+a(t)},htmlify:function(t){return t.match(/<p>[\s\S]*?<\/p>/)?t:"<p>"+t+"</p>"},unlinkify:function(t){return t?(t=t.replace(/<a\b[^>]*>/i,""),t=t.replace(/<\/a>/i,"")):t},getParamString:function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i+"="+t[i]);return"?"+e.join("&")},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},falseFn:function(){return!1},requestAnimFrame:function(){function t(t){window.setTimeout(t,1e3/60)}var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||t;return function(i,n,a,s){i=n?VCO.Util.bind(i,n):i,a&&e===t?i():e(i,s)}}(),bind:function(t,e){return function(){return t.apply(e,arguments)}},template:function(t,e){return t.replace(/\{ *([\w_]+) *\}/g,function(t,i){var n=e[i];if(!e.hasOwnProperty(i))throw new Error("No value provided for variable "+t);return n})},hexToRgb:function(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,function(t,e,i,n){return e+e+i+i+n+n});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null},ratio:{square:function(t){var e={w:0,h:0};return t.w>t.h&&t.h>0?(e.h=t.h,e.w=t.h):(e.w=t.w,e.h=t.w),e},r16_9:function(t){return null!==t.w&&""!==t.w?Math.round(t.w/16*9):null!==t.h&&""!==t.h?Math.round(t.h/9*16):0},r4_3:function(t){return null!==t.w&&""!==t.w?Math.round(t.w/4*3):null!==t.h&&""!==t.h?Math.round(t.h/3*4):void 0}},getObjectAttributeByIndex:function(t,e){if("undefined"!=typeof t){var i=0;for(var n in t){if(e===i)return t[n];i++}return""}return""},getUrlVars:function(t){var e,i=[],n,a;e=t.toString(),e.match("&#038;")?e=e.replace("&#038;","&"):e.match("&#38;")?e=e.replace("&#38;","&"):e.match("&amp;")&&(e=e.replace("&amp;","&")),a=e.slice(e.indexOf("?")+1).split("&");for(var s=0;s<a.length;s++)n=a[s].split("="),i.push(n[0]),i[n[0]]=n[1];return i},trim:function(t){return t.replace(/^\s+|\s+$/g,"")},slugify:function(t){t=VCO.Util.trim(t),t=t.toLowerCase();for(var e="ãàáäâẽèéëêìíïîõòóöôùúüûñç·/_,:;",i="aaaaaeeeeeiiiiooooouuuunc------",n=0,a=e.length;a>n;n++)t=t.replace(new RegExp(e.charAt(n),"g"),i.charAt(n));return t=t.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),t=t.replace(/^([0-9])/,"_$1")},maxDepth:function(t){for(var e=[],i=0,n=0;n<t.length;n++){if(e.push(t[n]),e.length>1){for(var a=e[e.length-1],s=-1,o=0;o<e.length-1;o++)e[o][1]<a[0]&&(s=o);s>=0&&(e=e.slice(s+1))}e.length>i&&(i=e.length)}return i},pad:function(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t}},function(t){var e=function(){function t(t){return null==t?String(t):W[Y.call(t)]||"object"}function e(e){return"function"==t(e)}function i(t){return null!=t&&t==t.window}function n(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function a(e){return"object"==t(e)}function s(t){return a(t)&&!i(t)&&Object.getPrototypeOf(t)==Object.prototype}function o(t){return"number"==typeof t.length}function r(t){return V.call(t,function(t){return null!=t})}function h(t){return t.length>0?$.fn.concat.apply([],t):t}function l(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function c(t){return t in T?T[t]:T[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function d(t,e){return"number"!=typeof e||E[l(t)]?e:e+"px"}function u(t){var e,i;return D[t]||(e=M.createElement(t),M.body.appendChild(e),i=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==i&&(i="block"),D[t]=i),D[t]}function m(t){return"children"in t?k.call(t.children):$.map(t.childNodes,function(t){return 1==t.nodeType?t:void 0})}function p(t,e,i){for(x in e)i&&(s(e[x])||K(e[x]))?(s(e[x])&&!s(t[x])&&(t[x]={}),K(e[x])&&!K(t[x])&&(t[x]=[]),p(t[x],e[x],i)):e[x]!==O&&(t[x]=e[x])}function _(t,e){return null==e?$(t):$(t).filter(e)}function f(t,i,n,a){return e(i)?i.call(t,n,a):i}function g(t,e,i){null==i?t.removeAttribute(e):t.setAttribute(e,i)}function v(t,e){var i=t.className,n=i&&i.baseVal!==O;return e===O?n?i.baseVal:i:void(n?i.baseVal=e:t.className=e)}function y(t){var e;try{return t?"true"==t||("false"==t?!1:"null"==t?null:/^0/.test(t)||isNaN(e=Number(t))?/^[\[\{]/.test(t)?$.parseJSON(t):t:e):t}catch(i){return t}}function C(t,e){e(t);for(var i in t.childNodes)C(t.childNodes[i],e)}var O,x,$,w,b=[],k=b.slice,V=b.filter,M=window.document,D={},T={},E={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},S=/^\s*<(\w+|!)[^>]*>/,L=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,A=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,N=/^(?:body|html)$/i,j=/([A-Z])/g,P=["val","css","html","text","data","width","height","offset"],I=["after","prepend","before","append"],U=M.createElement("table"),z=M.createElement("tr"),B={tr:M.createElement("tbody"),tbody:U,thead:U,tfoot:U,td:z,th:z,"*":M.createElement("div")},q=/complete|loaded|interactive/,R=/^\.([\w-]+)$/,H=/^#([\w-]*)$/,F=/^[\w-]*$/,W={},Y=W.toString,Z={},J,G,X=M.createElement("div"),Q={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},K=Array.isArray||function(t){return t instanceof Array};return Z.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var i=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(i)return i.call(t,e);var n,a=t.parentNode,s=!a;return s&&(a=X).appendChild(t),n=~Z.qsa(a,e).indexOf(t),s&&X.removeChild(t),n},J=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},G=function(t){return V.call(t,function(e,i){return t.indexOf(e)==i})},Z.fragment=function(t,e,i){var n,a,o;return L.test(t)&&(n=$(M.createElement(RegExp.$1))),n||(t.replace&&(t=t.replace(A,"<$1></$2>")),e===O&&(e=S.test(t)&&RegExp.$1),e in B||(e="*"),o=B[e],o.innerHTML=""+t,n=$.each(k.call(o.childNodes),function(){o.removeChild(this)})),s(i)&&(a=$(n),$.each(i,function(t,e){P.indexOf(t)>-1?a[t](e):a.attr(t,e)})),n},Z.Z=function(t,e){return t=t||[],t.__proto__=$.fn,t.selector=e||"",t},Z.isZ=function(t){return t instanceof Z.Z},Z.init=function(t,i){var n;if(!t)return Z.Z();if("string"==typeof t)if(t=t.trim(),"<"==t[0]&&S.test(t))n=Z.fragment(t,RegExp.$1,i),t=null;else{if(i!==O)return $(i).find(t);n=Z.qsa(M,t)}else{if(e(t))return $(M).ready(t);if(Z.isZ(t))return t;if(K(t))n=r(t);else if(a(t))n=[t],t=null;else if(S.test(t))n=Z.fragment(t.trim(),RegExp.$1,i),t=null;else{if(i!==O)return $(i).find(t);n=Z.qsa(M,t)}}return Z.Z(n,t)},$=function(t,e){return Z.init(t,e)},$.extend=function(t){var e,i=k.call(arguments,1);return"boolean"==typeof t&&(e=t,t=i.shift()),i.forEach(function(i){p(t,i,e)}),t},Z.qsa=function(t,e){var i,a="#"==e[0],s=!a&&"."==e[0],o=a||s?e.slice(1):e,r=F.test(o);return n(t)&&r&&a?(i=t.getElementById(o))?[i]:[]:1!==t.nodeType&&9!==t.nodeType?[]:k.call(r&&!a?s?t.getElementsByClassName(o):t.getElementsByTagName(e):t.querySelectorAll(e))},$.contains=function(t,e){return t!==e&&t.contains(e)},$.type=t,$.isFunction=e,$.isWindow=i,$.isArray=K,$.isPlainObject=s,$.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},$.inArray=function(t,e,i){return b.indexOf.call(e,t,i)},$.camelCase=J,$.trim=function(t){return null==t?"":String.prototype.trim.call(t)},$.uuid=0,$.support={},$.expr={},$.map=function(t,e){var i,n=[],a,s;if(o(t))for(a=0;a<t.length;a++)i=e(t[a],a),null!=i&&n.push(i);else for(s in t)i=e(t[s],s),null!=i&&n.push(i);return h(n)},$.each=function(t,e){var i,n;if(o(t)){for(i=0;i<t.length;i++)if(e.call(t[i],i,t[i])===!1)return t}else for(n in t)if(e.call(t[n],n,t[n])===!1)return t;return t},$.grep=function(t,e){return V.call(t,e)},window.JSON&&($.parseJSON=JSON.parse),$.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){W["[object "+e+"]"]=e.toLowerCase()}),$.fn={forEach:b.forEach,reduce:b.reduce,push:b.push,sort:b.sort,indexOf:b.indexOf,concat:b.concat,map:function(t){return $($.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return $(k.apply(this,arguments))},ready:function(t){return q.test(M.readyState)&&M.body?t($):M.addEventListener("DOMContentLoaded",function(){t($)},!1),this},get:function(t){return t===O?k.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return b.every.call(this,function(e,i){return t.call(e,i,e)!==!1}),this},filter:function(t){return e(t)?this.not(this.not(t)):$(V.call(this,function(e){return Z.matches(e,t)}))},add:function(t,e){return $(G(this.concat($(t,e))))},is:function(t){return this.length>0&&Z.matches(this[0],t)},not:function(t){var i=[];if(e(t)&&t.call!==O)this.each(function(e){t.call(this,e)||i.push(this)});else{var n="string"==typeof t?this.filter(t):o(t)&&e(t.item)?k.call(t):$(t);this.forEach(function(t){n.indexOf(t)<0&&i.push(t)})}return $(i)},has:function(t){return this.filter(function(){return a(t)?$.contains(this,t):$(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!a(t)?t:$(t)},last:function(){var t=this[this.length-1];return t&&!a(t)?t:$(t)},find:function(t){var e,i=this;return e="object"==typeof t?$(t).filter(function(){var t=this;return b.some.call(i,function(e){return $.contains(e,t)})}):1==this.length?$(Z.qsa(this[0],t)):this.map(function(){return Z.qsa(this,t)})},closest:function(t,e){var i=this[0],a=!1;for("object"==typeof t&&(a=$(t));i&&!(a?a.indexOf(i)>=0:Z.matches(i,t));)i=i!==e&&!n(i)&&i.parentNode;return $(i)},parents:function(t){for(var e=[],i=this;i.length>0;)i=$.map(i,function(t){return(t=t.parentNode)&&!n(t)&&e.indexOf(t)<0?(e.push(t),t):void 0});return _(e,t)},parent:function(t){return _(G(this.pluck("parentNode")),t)},children:function(t){return _(this.map(function(){return m(this)}),t)},contents:function(){return this.map(function(){return k.call(this.childNodes)})},siblings:function(t){return _(this.map(function(t,e){return V.call(m(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return $.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=u(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var i=e(t);if(this[0]&&!i)var n=$(t).get(0),a=n.parentNode||this.length>1;return this.each(function(e){$(this).wrapAll(i?t.call(this,e):a?n.cloneNode(!0):n)})},wrapAll:function(t){if(this[0]){$(this[0]).before(t=$(t));for(var e;(e=t.children()).length;)t=e.first();$(t).append(this)}return this},wrapInner:function(t){var i=e(t);return this.each(function(e){var n=$(this),a=n.contents(),s=i?t.call(this,e):t;a.length?a.wrapAll(s):n.append(s)})},unwrap:function(){return this.parent().each(function(){$(this).replaceWith($(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=$(this);(t===O?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(t){return $(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return $(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return 0===arguments.length?this.length>0?this[0].innerHTML:null:this.each(function(e){var i=this.innerHTML;$(this).empty().append(f(this,t,e,i))})},text:function(t){return 0===arguments.length?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=t===O?"":""+t})},attr:function(t,e){var i;return"string"==typeof t&&e===O?0==this.length||1!==this[0].nodeType?O:"value"==t&&"INPUT"==this[0].nodeName?this.val():!(i=this[0].getAttribute(t))&&t in this[0]?this[0][t]:i:this.each(function(i){if(1===this.nodeType)if(a(t))for(x in t)g(this,x,t[x]);else g(this,t,f(this,e,i,this.getAttribute(t)))})},removeAttr:function(t){return this.each(function(){1===this.nodeType&&g(this,t)})},prop:function(t,e){return t=Q[t]||t,e===O?this[0]&&this[0][t]:this.each(function(i){this[t]=f(this,e,i,this[t])})},data:function(t,e){var i=this.attr("data-"+t.replace(j,"-$1").toLowerCase(),e);return null!==i?y(i):O},val:function(t){return 0===arguments.length?this[0]&&(this[0].multiple?$(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(e){this.value=f(this,t,e,this.value)})},offset:function(t){if(t)return this.each(function(e){var i=$(this),n=f(this,t,e,i.offset()),a=i.offsetParent().offset(),s={top:n.top-a.top,left:n.left-a.left};"static"==i.css("position")&&(s.position="relative"),i.css(s)});if(0==this.length)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,i){if(arguments.length<2){var n=this[0],a=getComputedStyle(n,"");if(!n)return;if("string"==typeof e)return n.style[J(e)]||a.getPropertyValue(e);if(K(e)){var s={};return $.each(K(e)?e:[e],function(t,e){s[e]=n.style[J(e)]||a.getPropertyValue(e)}),s}}var o="";if("string"==t(e))i||0===i?o=l(e)+":"+d(e,i):this.each(function(){this.style.removeProperty(l(e))});else for(x in e)e[x]||0===e[x]?o+=l(x)+":"+d(x,e[x])+";":this.each(function(){this.style.removeProperty(l(x))});return this.each(function(){this.style.cssText+=";"+o})},index:function(t){return t?this.indexOf($(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return t?b.some.call(this,function(t){return this.test(v(t))},c(t)):!1},addClass:function(t){return t?this.each(function(e){w=[];var i=v(this),n=f(this,t,e,i);n.split(/\s+/g).forEach(function(t){$(this).hasClass(t)||w.push(t)},this),w.length&&v(this,i+(i?" ":"")+w.join(" "))}):this},removeClass:function(t){return this.each(function(e){return t===O?v(this,""):(w=v(this),f(this,t,e,w).split(/\s+/g).forEach(function(t){w=w.replace(c(t)," ")}),void v(this,w.trim()))})},toggleClass:function(t,e){return t?this.each(function(i){var n=$(this),a=f(this,t,i,v(this));a.split(/\s+/g).forEach(function(t){(e===O?!n.hasClass(t):e)?n.addClass(t):n.removeClass(t)})}):this},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return t===O?e?this[0].scrollTop:this[0].pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return t===O?e?this[0].scrollLeft:this[0].pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),i=this.offset(),n=N.test(e[0].nodeName)?{top:0,left:0}:e.offset();return i.top-=parseFloat($(t).css("margin-top"))||0,i.left-=parseFloat($(t).css("margin-left"))||0,n.top+=parseFloat($(e[0]).css("border-top-width"))||0,n.left+=parseFloat($(e[0]).css("border-left-width"))||0,{top:i.top-n.top,left:i.left-n.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||M.body;t&&!N.test(t.nodeName)&&"static"==$(t).css("position");)t=t.offsetParent;return t})}},$.fn.detach=$.fn.remove,["width","height"].forEach(function(t){var e=t.replace(/./,function(t){return t[0].toUpperCase()});$.fn[t]=function(a){var s,o=this[0];return a===O?i(o)?o["inner"+e]:n(o)?o.documentElement["scroll"+e]:(s=this.offset())&&s[t]:this.each(function(e){o=$(this),o.css(t,f(this,a,e,o[t]()))})}}),I.forEach(function(e,i){var n=i%2;$.fn[e]=function(){var e,a=$.map(arguments,function(i){return e=t(i),"object"==e||"array"==e||null==i?i:Z.fragment(i)}),s,o=this.length>1;return a.length<1?this:this.each(function(t,e){s=n?e:e.parentNode,e=0==i?e.nextSibling:1==i?e.firstChild:2==i?e:null,a.forEach(function(t){if(o)t=t.cloneNode(!0);else if(!s)return $(t).remove();C(s.insertBefore(t,e),function(t){null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||window.eval.call(window,t.innerHTML)})})})},$.fn[n?e+"To":"insert"+(i?"Before":"After")]=function(t){return $(t)[e](this),this}}),Z.Z.prototype=$.fn,Z.uniq=G,Z.deserializeValue=y,$.zepto=Z,$}();window.Zepto=e,void 0===window.$&&(window.$=e),function($){function t(t){return t._zid||(t._zid=d++)}function e(e,a,s,o){if(a=i(a),a.ns)var r=n(a.ns);return(f[t(e)]||[]).filter(function(e){return!(!e||a.e&&e.e!=a.e||a.ns&&!r.test(e.ns)||s&&t(e.fn)!==t(s)||o&&e.sel!=o)})}function i(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function n(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function a(t,e){return t.del&&!v&&t.e in y||!!e}function s(t){return C[t]||v&&y[t]||t}function o(e,n,o,r,l,c,d){var m=t(e),p=f[m]||(f[m]=[]);n.split(/\s/).forEach(function(t){if("ready"==t)return $(document).ready(o);var n=i(t);n.fn=o,n.sel=l,n.e in C&&(o=function(t){var e=t.relatedTarget;return!e||e!==this&&!$.contains(this,e)?n.fn.apply(this,arguments):void 0}),n.del=c;var m=c||o;n.proxy=function(t){if(t=h(t),!t.isImmediatePropagationStopped()){t.data=r;var i=m.apply(e,t._args==u?[t]:[t].concat(t._args));return i===!1&&(t.preventDefault(),t.stopPropagation()),i}},n.i=p.length,p.push(n),"addEventListener"in e&&e.addEventListener(s(n.e),n.proxy,a(n,d))})}function r(i,n,o,r,h){var l=t(i);(n||"").split(/\s/).forEach(function(t){e(i,t,o,r).forEach(function(t){delete f[l][t.i],"removeEventListener"in i&&i.removeEventListener(s(t.e),t.proxy,a(t,h))})})}function h(t,e){return(e||!t.isDefaultPrevented)&&(e||(e=t),$.each(b,function(i,n){var a=e[i];t[i]=function(){return this[n]=O,a&&a.apply(e,arguments)},t[n]=x}),(e.defaultPrevented!==u?e.defaultPrevented:"returnValue"in e?e.returnValue===!1:e.getPreventDefault&&e.getPreventDefault())&&(t.isDefaultPrevented=O)),t}function l(t){var e,i={originalEvent:t};for(e in t)w.test(e)||t[e]===u||(i[e]=t[e]);return h(i,t)}var c=$.zepto.qsa,d=1,u,m=Array.prototype.slice,p=$.isFunction,_=function(t){return"string"==typeof t},f={},g={},v="onfocusin"in window,y={focus:"focusin",blur:"focusout"},C={mouseenter:"mouseover",mouseleave:"mouseout"};g.click=g.mousedown=g.mouseup=g.mousemove="MouseEvents",$.event={add:o,remove:r},$.proxy=function(e,i){if(p(e)){var n=function(){return e.apply(i,arguments)};return n._zid=t(e),n}if(_(i))return $.proxy(e[i],e);throw new TypeError("expected function")},$.fn.bind=function(t,e,i){return this.on(t,e,i)},$.fn.unbind=function(t,e){return this.off(t,e)},$.fn.one=function(t,e,i,n){return this.on(t,e,i,n,1)};var O=function(){return!0},x=function(){return!1},w=/^([A-Z]|returnValue$|layer[XY]$)/,b={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};$.fn.delegate=function(t,e,i){return this.on(e,t,i)},$.fn.undelegate=function(t,e,i){return this.off(e,t,i)},$.fn.live=function(t,e){return $(document.body).delegate(this.selector,t,e),this},$.fn.die=function(t,e){return $(document.body).undelegate(this.selector,t,e),this},$.fn.on=function(t,e,i,n,a){var s,h,c=this;return t&&!_(t)?($.each(t,function(t,n){c.on(t,e,i,n,a)}),c):(_(e)||p(n)||n===!1||(n=i,i=e,e=u),(p(i)||i===!1)&&(n=i,i=u),n===!1&&(n=x),c.each(function(c,d){a&&(s=function(t){return r(d,t.type,n),n.apply(this,arguments)}),e&&(h=function(t){var i,a=$(t.target).closest(e,d).get(0);return a&&a!==d?(i=$.extend(l(t),{currentTarget:a,liveFired:d}),(s||n).apply(a,[i].concat(m.call(arguments,1)))):void 0}),o(d,t,n,i,e,h||s)}))},$.fn.off=function(t,e,i){var n=this;return t&&!_(t)?($.each(t,function(t,i){n.off(t,e,i)}),n):(_(e)||p(i)||i===!1||(i=e,e=u),i===!1&&(i=x),n.each(function(){r(this,t,i,e)}))},$.fn.trigger=function(t,e){return t=_(t)||$.isPlainObject(t)?$.Event(t):h(t),t._args=e,this.each(function(){"dispatchEvent"in this?this.dispatchEvent(t):$(this).triggerHandler(t,e)})},$.fn.triggerHandler=function(t,i){var n,a;return this.each(function(s,o){n=l(_(t)?$.Event(t):t),n._args=i,n.target=o,$.each(e(o,t.type||t),function(t,e){return a=e.proxy(n),n.isImmediatePropagationStopped()?!1:void 0})}),a},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){$.fn[t]=function(e){return e?this.bind(t,e):this.trigger(t)}}),["focus","blur"].forEach(function(t){$.fn[t]=function(e){return e?this.bind(t,e):this.each(function(){try{this[t]()}catch(e){}}),this}}),$.Event=function(t,e){_(t)||(e=t,t=e.type);var i=document.createEvent(g[t]||"Events"),n=!0;if(e)for(var a in e)"bubbles"==a?n=!!e[a]:i[a]=e[a];return i.initEvent(t,n,!0),h(i)}}(e),function($){function t(t,e,i){var n=$.Event(e);return $(t).trigger(n,i),!n.isDefaultPrevented()}function e(e,i,n,a){return e.global?t(i||_,n,a):void 0}function i(t){t.global&&0===$.active++&&e(t,null,"ajaxStart")}function n(t){t.global&&!--$.active&&e(t,null,"ajaxStop")}function a(t,i){var n=i.context;return i.beforeSend.call(n,t,i)===!1||e(i,n,"ajaxBeforeSend",[t,i])===!1?!1:void e(i,n,"ajaxSend",[t,i])}function s(t,i,n,a){var s=n.context,o="success";n.success.call(s,t,o,i),a&&a.resolveWith(s,[t,o,i]),e(n,s,"ajaxSuccess",[i,n,t]),r(o,i,n)}function o(t,i,n,a,s){var o=a.context;a.error.call(o,n,i,t),s&&s.rejectWith(o,[n,i,t]),e(a,o,"ajaxError",[n,a,t||i]),r(i,n,a)}function r(t,i,a){var s=a.context;a.complete.call(s,i,t),e(a,s,"ajaxComplete",[i,a]),n(a)}function h(){}function l(t){return t&&(t=t.split(";",2)[0]),t&&(t==x?"html":t==O?"json":y.test(t)?"script":C.test(t)&&"xml")||"text"}function c(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function d(t){t.processData&&t.data&&"string"!=$.type(t.data)&&(t.data=$.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=c(t.url,t.data),t.data=void 0)}function u(t,e,i,n){var a=!$.isFunction(e);return{url:t,data:a?e:void 0,success:a?$.isFunction(i)?i:void 0:e,dataType:a?n||i:i}}function m(t,e,i,n){var a,s=$.isArray(e),o=$.isPlainObject(e);$.each(e,function(e,r){a=$.type(r),n&&(e=i?n:n+"["+(o||"object"==a||"array"==a?e:"")+"]"),!n&&s?t.add(r.name,r.value):"array"==a||!i&&"object"==a?m(t,r,i,e):t.add(e,r)})}var p=0,_=window.document,f,g,v=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,y=/^(?:text|application)\/javascript/i,C=/^(?:text|application)\/xml/i,O="application/json",x="text/html",w=/^\s*$/;$.active=0,$.ajaxJSONP=function(t,e){if(!("type"in t))return $.ajax(t);var i=t.jsonpCallback,n=($.isFunction(i)?i():i)||"jsonp"+ ++p,r=_.createElement("script"),h=window[n],l,c=function(t){$(r).triggerHandler("error",t||"abort")},d={abort:c},u;return e&&e.promise(d),$(r).on("load error",function(i,a){clearTimeout(u),$(r).off().remove(),"error"!=i.type&&l?s(l[0],d,t,e):o(null,a||"error",d,t,e),window[n]=h,l&&$.isFunction(h)&&h(l[0]),h=l=void 0}),a(d,t)===!1?(c("abort"),d):(window[n]=function(){l=arguments},r.src=t.url.replace(/\?(.+)=\?/,"?$1="+n),_.head.appendChild(r),t.timeout>0&&(u=setTimeout(function(){c("timeout")},t.timeout)),d)},$.ajaxSettings={type:"GET",beforeSend:h,success:h,error:h,complete:h,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:O,xml:"application/xml, text/xml",html:x,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},$.ajax=function(t){var e=$.extend({},t||{}),n=$.Deferred&&$.Deferred();for(f in $.ajaxSettings)void 0===e[f]&&(e[f]=$.ajaxSettings[f]);i(e),e.crossDomain||(e.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(e.url)&&RegExp.$2!=window.location.host),e.url||(e.url=window.location.toString()),d(e),e.cache===!1&&(e.url=c(e.url,"_="+Date.now()));var r=e.dataType,u=/\?.+=\?/.test(e.url);if("jsonp"==r||u)return u||(e.url=c(e.url,e.jsonp?e.jsonp+"=?":e.jsonp===!1?"":"callback=?")),$.ajaxJSONP(e,n);var m=e.accepts[r],p={},_=function(t,e){p[t.toLowerCase()]=[t,e]},v=/^([\w-]+:)\/\//.test(e.url)?RegExp.$1:window.location.protocol,y=e.xhr(),C=y.setRequestHeader,O;if(n&&n.promise(y),e.crossDomain||_("X-Requested-With","XMLHttpRequest"),_("Accept",m||"*/*"),(m=e.mimeType||m)&&(m.indexOf(",")>-1&&(m=m.split(",",2)[0]),y.overrideMimeType&&y.overrideMimeType(m)),(e.contentType||e.contentType!==!1&&e.data&&"GET"!=e.type.toUpperCase())&&_("Content-Type",e.contentType||"application/x-www-form-urlencoded"),e.headers)for(g in e.headers)_(g,e.headers[g]);if(y.setRequestHeader=_,y.onreadystatechange=function(){if(4==y.readyState){y.onreadystatechange=h,clearTimeout(O);var t,i=!1;if(y.status>=200&&y.status<300||304==y.status||0==y.status&&"file:"==v){r=r||l(e.mimeType||y.getResponseHeader("content-type")),t=y.responseText;try{"script"==r?(1,eval)(t):"xml"==r?t=y.responseXML:"json"==r&&(t=w.test(t)?null:$.parseJSON(t))}catch(a){i=a}i?o(i,"parsererror",y,e,n):s(t,y,e,n)}else o(y.statusText||null,y.status?"error":"abort",y,e,n)}},a(y,e)===!1)return y.abort(),o(null,"abort",y,e,n),y;if(e.xhrFields)for(g in e.xhrFields)y[g]=e.xhrFields[g];var x="async"in e?e.async:!0;y.open(e.type,e.url,x,e.username,e.password);for(g in p)C.apply(y,p[g]);return e.timeout>0&&(O=setTimeout(function(){y.onreadystatechange=h,y.abort(),o(null,"timeout",y,e,n)},e.timeout)),y.send(e.data?e.data:null),y},$.get=function(t,e,i,n){return $.ajax(u.apply(null,arguments))},$.post=function(t,e,i,n){var a=u.apply(null,arguments);return a.type="POST",$.ajax(a)},$.getJSON=function(t,e,i){var n=u.apply(null,arguments);return n.dataType="json",$.ajax(n)},$.fn.load=function(t,e,i){if(!this.length)return this;var n=this,a=t.split(/\s/),s,o=u(t,e,i),r=o.success;return a.length>1&&(o.url=a[0],s=a[1]),o.success=function(t){n.html(s?$("<div>").html(t.replace(v,"")).find(s):t),r&&r.apply(n,arguments)},$.ajax(o),this};var b=encodeURIComponent;$.param=function(t,e){var i=[];return i.add=function(t,e){this.push(b(t)+"="+b(e))},m(i,t,e),i.join("&").replace(/%20/g,"+")}}(e),function($){$.fn.serializeArray=function(){var t=[],e;return $([].slice.call(this.get(0).elements)).each(function(){e=$(this);var i=e.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&("radio"!=i&&"checkbox"!=i||this.checked)&&t.push({name:e.attr("name"),value:e.val()})}),t},$.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},$.fn.submit=function(t){if(t)this.bind("submit",t);else if(this.length){var e=$.Event("submit");this.eq(0).trigger(e),e.isDefaultPrevented()||this.get(0).submit()}return this}}(e),function($){"__proto__"in{}||$.extend($.zepto,{Z:function(t,e){return t=t||[],$.extend(t,$.fn),t.selector=e||"",t.__Z=!0,t},isZ:function(t){return"array"===$.type(t)&&"__Z"in t}});try{getComputedStyle(void 0)}catch(t){var e=getComputedStyle;window.getComputedStyle=function(t){try{return e(t)}catch(i){return null}}}}(e),t.getJSON=e.getJSON,t.ajax=e.ajax}(VCO),VCO.Class=function(){},VCO.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments)},i=function(){};i.prototype=this.prototype;var n=new i;n.constructor=e,e.prototype=n,e.superclass=this.prototype;for(var a in this)this.hasOwnProperty(a)&&"prototype"!==a&&"superclass"!==a&&(e[a]=this[a]);return t.statics&&(VCO.Util.extend(e,t.statics),delete t.statics),t.includes&&(VCO.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),t.options&&n.options&&(t.options=VCO.Util.extend({},n.options,t.options)),VCO.Util.extend(n,t),e.extend=VCO.Class.extend,e.include=function(t){VCO.Util.extend(this.prototype,t)},e},VCO.Events={addEventListener:function(t,e,i){var n=this._vco_events=this._vco_events||{};return n[t]=n[t]||[],n[t].push({action:e,context:i||this}),this},hasEventListeners:function(t){var e="_vco_events";return e in this&&t in this[e]&&this[e][t].length>0},removeEventListener:function(t,e,i){if(!this.hasEventListeners(t))return this;for(var n=0,a=this._vco_events,s=a[t].length;s>n;n++)if(a[t][n].action===e&&(!i||a[t][n].context===i))return a[t].splice(n,1),this;return this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;for(var i=VCO.Util.extend({type:t,target:this},e),n=this._vco_events[t].slice(),a=0,s=n.length;s>a;a++)n[a].action.call(n[a].context||this,i);return this}},VCO.Events.on=VCO.Events.addEventListener,VCO.Events.off=VCO.Events.removeEventListener,VCO.Events.fire=VCO.Events.fireEvent,function(){var t=navigator.userAgent.toLowerCase(),e=document.documentElement,i="ActiveXObject"in window,n=-1!==t.indexOf("webkit"),a=-1!==t.indexOf("phantom"),s=-1!==t.search("android [23]"),o="undefined"!=typeof orientation,r=navigator.msPointerEnabled&&navigator.msMaxTouchPoints&&!window.PointerEvent,h=window.PointerEvent&&navigator.pointerEnabled&&navigator.maxTouchPoints||r,l=i&&"transition"in e.style,c="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!s,d="MozPerspective"in e.style,u="OTransition"in e.style,m=window.opera,p="devicePixelRatio"in window&&window.devicePixelRatio>1;if(!p&&"matchMedia"in window){var _=window.matchMedia("(min-resolution:144dpi)");p=_&&_.matches}var f=!window.L_NO_TOUCH&&!a&&(h||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch);VCO.Browser={ie:i,ielt9:i&&!document.addEventListener,webkit:n,firefox:-1!==t.indexOf("gecko")&&!n&&!window.opera&&!i,android:-1!==t.indexOf("android"),android23:s,chrome:-1!==t.indexOf("chrome"),ie3d:l,webkit3d:c,gecko3d:d,opera3d:u,any3d:!window.L_DISABLE_3D&&(l||c||d||u)&&!a,mobile:o,mobileWebkit:o&&n,mobileWebkit3d:o&&c,mobileOpera:o&&window.opera,touch:!!f,msPointer:!!r,pointer:!!h,retina:!!p,orientation:function(){var t=window.innerWidth,e=window.innerHeight,i="portrait";
return t>e&&(i="landscape"),90==Math.abs(window.orientation),trace(i),i}}}(),VCO.Load=function(t){function e(t){var e=0,n=!1;for(e=0;e<i.length;e++)i[e]==t&&(n=!0);return n?!0:(i.push(t),!1)}var i=[];return{css:function(t,i,n,a){e(t)?i():VCO.LoadIt.css(t,i,n,a)},js:function(t,i,n,a){e(t)?i():VCO.LoadIt.js(t,i,n,a)}}}(this.document),VCO.LoadIt=function(t){function e(e,i){var n=t.createElement(e),a;for(a in i)i.hasOwnProperty(a)&&n.setAttribute(a,i[a]);return n}function i(t){var e=l[t],i,n;e&&(i=e.callback,n=e.urls,n.shift(),c=0,n.length||(i&&i.call(e.context,e.obj),l[t]=null,d[t].length&&a(t)))}function n(){var e=navigator.userAgent;r={async:t.createElement("script").async===!0},(r.webkit=/AppleWebKit\//.test(e))||(r.ie=/MSIE/.test(e))||(r.opera=/Opera/.test(e))||(r.gecko=/Gecko\//.test(e))||(r.unknown=!0)}function a(a,c,u,m,p){var _=function(){i(a)},f="css"===a,g=[],v,y,C,O,x,w;if(r||n(),c)if(c="string"==typeof c?[c]:c.concat(),f||r.async||r.gecko||r.opera)d[a].push({urls:c,callback:u,obj:m,context:p});else for(v=0,y=c.length;y>v;++v)d[a].push({urls:[c[v]],callback:v===y-1?u:null,obj:m,context:p});if(!l[a]&&(O=l[a]=d[a].shift())){for(h||(h=t.head||t.getElementsByTagName("head")[0]),x=O.urls,v=0,y=x.length;y>v;++v)w=x[v],f?C=r.gecko?e("style"):e("link",{href:w,rel:"stylesheet"}):(C=e("script",{src:w}),C.async=!1),C.className="lazyload",C.setAttribute("charset","utf-8"),r.ie&&!f?C.onreadystatechange=function(){/loaded|complete/.test(C.readyState)&&(C.onreadystatechange=null,_())}:f&&(r.gecko||r.webkit)?r.webkit?(O.urls[v]=C.href,o()):(C.innerHTML='@import "'+w+'";',s(C)):C.onload=C.onerror=_,g.push(C);for(v=0,y=g.length;y>v;++v)h.appendChild(g[v])}}function s(t){var e;try{e=!!t.sheet.cssRules}catch(n){return c+=1,void(200>c?setTimeout(function(){s(t)},50):e&&i("css"))}i("css")}function o(){var t=l.css,e;if(t){for(e=u.length;--e>=0;)if(u[e].href===t.urls[0]){i("css");break}c+=1,t&&(200>c?setTimeout(o,50):i("css"))}}var r,h,l={},c=0,d={css:[],js:[]},u=t.styleSheets;return{css:function(t,e,i,n){a("css",t,e,i,n)},js:function(t,e,i,n){a("js",t,e,i,n)}}}(this.document),VCO.TimelineConfig=VCO.Class.extend({VALID_PROPERTIES:["scale","slides"],initialize:function(t,e){if("string"==typeof t){var i=this;VCO.ajax({type:"GET",url:t,dataType:"json",success:function(t){if(!t||!t.timeline)throw"data must have a timeline property";i._importProperties(t.timeline),i._cleanData(),e&&e(i)},error:function(t,e){throw trace(t),trace(e),"Configuration could not be loaded: "+e}})}else{if("object"!=typeof t)throw"Invalid Argument";if(!t.timeline)throw"data must have a timeline property";this._importProperties(t.timeline),this._cleanData(),e&&e(this)}},_cleanData:function(){this._makeUniqueIdentifiers(this.slides),this._processDates(this.slides),VCO.DateUtil.sortByDate(this.slides)},_importProperties:function(t){for(var e=0;e<this.VALID_PROPERTIES.length;e++)k=this.VALID_PROPERTIES[e],this[k]=t[k]},_makeUniqueIdentifiers:function(t){for(var e=[],i=0;i<t.length;i++)t[i].uniqueid&&t[i].uniqueid.replace(/\s+/,"").length>0&&(t[i].uniqueid=VCO.Util.slugify(t[i].uniqueid),-1!=e.indexOf(t[i].uniqueid)?t[i].uniqueid="":e.push(t[i].uniqueid));if(e.length!=t.length)for(var i=0;i<t.length;i++)if(!t[i].uniqueid){var n=t[i].text?VCO.Util.slugify(t[i].text.headline):null;n||(n=VCO.Util.unique_ID(6)),-1!=e.indexOf(n)&&(n=n+"-"+i),e.push(n),t[i].uniqueid=n}},_processDates:function(t){var e=null;if(!this.scale){trace("Determining scale dynamically"),this.scale="javascript";for(var i=0;i<t.length;i++){if("undefined"==typeof t[i].start_date)throw"item "+i+" is missing a start_date";var n=new VCO.BigDate(t[i].start_date),a=n.data.date_obj.year;if(-271820>a||a>275759){this.scale="cosmological";break}}}if("javascript"==this.scale)e=VCO.Date,trace("using VCO.Date");else{if("cosmological"!=this.scale)throw"Don't know how to process dates on scale "+this.scale;e=VCO.BigDate,trace("using VCO.BigDate")}for(var i=0;i<t.length;i++){if("undefined"==typeof t[i].start_date)throw"item "+i+" is missing a start_date";t[i].start_date=new e(t[i].start_date),"undefined"!=typeof t[i].end_date&&(t[i].end_date=new e(t[i].end_date))}}}),function(t){function e(t){var e=/\bkey=([_A-Za-z0-9]+)&?/i;if(t.match(e))return t.match(e)[1];var i=null;if(t.match("docs.google.com/spreadsheets/d/")){var n=t.indexOf("docs.google.com/spreadsheets/d/")+"docs.google.com/spreadsheets/d/".length,a=t.substr(n);i=a.split("/")[0]}return i||(i=t),i}function i(e){var i={};for(k in e)0==k.indexOf("gsx$")&&(i[k.substr(4)]=e[k].$t);if(!i.startdate)throw"All items must have a start date column.";var n={media:{caption:i.mediacaption||"",credit:i.mediacredit||"",url:i.media||"",thumb:""},text:{headline:i.headline||"",text:i.text||""}};return n.start_date=t.Date.parseDate(i.startdate),e.enddate&&(n.end_date=t.Date.parseDate(e.enddate)),n}t.ConfigFactory={fromGoogle:function(n){var a=e(n),s="od6";n="https://spreadsheets.google.com/feeds/list/"+a+"/"+s+"/public/values?alt=json";var o=t.ajax({url:n,async:!1}),r=[];o=JSON.parse(o.responseText),window.google_data=o;for(var h=0;h<o.feed.entry.length;h++)r.push(i(o.feed.entry[h]));return{scale:"javascript",timeline:{slides:r}}}}}(VCO),VCO.Language=function(t){for(k in VCO.Language.languages.en)this[k]=VCO.Language.languages.en[k];if(t&&t.language&&"string"==typeof t.language&&"en"!=t.language){var e=t.language;if(!(e in VCO.Language.languages)){if(/\.json$/.test(e))var i=e;else{var n="/locale/"+e+".json",a=t.script_path||"";/\/$/.test(a)&&(n=n.substr(1));var i=a+n}var s=this,o=VCO.ajax({url:i,async:!1});if(200!=o.status)throw"Could not load language ["+e+"]: "+o.statusText;VCO.Language.languages[e]=JSON.parse(o.responseText)}VCO.Util.mergeData(this,VCO.Language.languages[e])}},VCO.Language.formatNumber=function(t,e){if(e.match(/%(\.(\d+))?f/)){var i=e.match(/%(\.(\d+))?f/),n=i[0];return i[2]&&(t=t.toFixed(i[2])),e.replace(n,t)}return e},VCO.Language.prototype.mergeData=function(t){for(k in VCO.Language.languages.en)t[k]&&("object"==typeof this[k]?VCO.Util.mergeData(t[k],this[k]):this[k]=t[k])},VCO.Language.fallback={messages:{}},VCO.Language.prototype.getMessage=function(t){return this.messages[t]||VCO.Language.fallback.messages[t]||t},VCO.Language.prototype._=VCO.Language.prototype.getMessage,VCO.Language.prototype.formatDate=function(t,e){return t.constructor==Date?this.formatJSDate(t,e):t.constructor==VCO.BigYear?this.formatBigYear(t,e):t.data&&t.data.date_obj?this.formatDate(t.data.date_obj,e):(trace("Unfamiliar date presented for formatting"),t.toString())},VCO.Language.prototype.formatBigYear=function(t,e){var i=t.year,n=this.bigdateformats[e]||this.bigdateformats.fallback;if(n){for(var a=0;a<n.length;a++){var s=n[a];if(Math.abs(i/s[0])>1)return VCO.Language.formatNumber(Math.abs(i/s[0]),s[1])}return i.toString()}return trace("Language file dateformats missing cosmological. Falling back."),VCO.Language.formatNumber(i,e)},VCO.Language.prototype.formatJSDate=function(t,e){var i=!1,n=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,a=/[^-+\dA-Z]/g;e||(e="full");var s=this.dateformats[e]||VCO.Language.fallback.dateformats[e];s||(s=e);var o=i?"getUTC":"get",r=t[o+"Date"](),h=t[o+"Day"](),l=t[o+"Month"](),c=t[o+"FullYear"](),d=t[o+"Hours"](),u=t[o+"Minutes"](),m=t[o+"Seconds"](),p=t[o+"Milliseconds"](),_=i?0:t.getTimezoneOffset(),f="",g={d:r,dd:VCO.Util.pad(r),ddd:this.date.day_abbr[h],dddd:this.date.day[h],m:l+1,mm:VCO.Util.pad(l+1),mmm:this.date.month_abbr[l],mmmm:this.date.month[l],yy:String(c).slice(2),yyyy:this.use_bc&&0>c?f=Math.abs(c)+" "+this.use_bc:c,h:d%12||12,hh:VCO.Util.pad(d%12||12),H:d,HH:VCO.Util.pad(d),M:u,MM:VCO.Util.pad(u),s:m,ss:VCO.Util.pad(m),l:VCO.Util.pad(p,3),L:VCO.Util.pad(p>99?Math.round(p/10):p),t:12>d?"a":"p",tt:12>d?"am":"pm",T:12>d?"A":"P",TT:12>d?"AM":"PM",Z:i?"UTC":(String(t).match(n)||[""]).pop().replace(a,""),o:(_>0?"-":"+")+VCO.Util.pad(100*Math.floor(Math.abs(_)/60)+Math.abs(_)%60,4),S:["th","st","nd","rd"][r%10>3?0:(r%100-r%10!=10)*r%10]};return s.replace(VCO.Language.DATE_FORMAT_TOKENS,function(t){return t in g?g[t]:t.slice(1,t.length-1)})},VCO.Language.DATE_FORMAT_TOKENS=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,VCO.Language.languages={en:{name:"English",lang:"en",messages:{loading:"Loading",wikipedia:"From Wikipedia, the free encyclopedia"},date:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],month_abbr:["Jan.","Feb.","March","April","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."],day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_abbr:["Sun.","Mon.","Tues.","Wed.","Thurs.","Fri.","Sat."]},dateformats:{year:"yyyy",month_short:"mmm",month:"mmmm yyyy",full_short:"mmm d",full:"mmmm d',' yyyy",time:"h:MM:ss TT' <small>'mmmm d',' yyyy'</small>'",time_short:"h:MM:ss TT",time_no_seconds_short:"h:MM TT",time_no_minutes_short:"h TT",time_no_seconds_small_date:"h:MM TT' <small>'mmmm d',' yyyy'</small>'",full_long:"mmm d',' yyyy 'at' h:MM TT",full_long_small_date:"h:MM TT' <small>mmm d',' yyyy'</small>'"},bigdateformats:{fallback:[[1e9,"%.2f billion years ago"],[1e6,"%.1f million years ago"],[1e3,"%.1f thousand years ago"],[1,"%f years ago"]],compact:[[1e9,"%.2f bya"],[1e6,"%.1f mya"],[1e3,"%.1f kya"],[1,"%f years ago"]],verbose:[[1e9,"%.2f billion years ago"],[1e6,"%.1f million years ago"],[1e3,"%.1f thousand years ago"],[1,"%f years ago"]]}}},VCO.Language.fallback=new VCO.Language,VCO.I18NMixins={getLanguage:function(){return this.options&&this.options.language?this.options.language:(trace("Expected a language option"),VCO.Language.fallback)},_:function(t){return this.getLanguage()._(t)}},VCO.Easings={ease:[.25,.1,.25,1],linear:[0,0,1,1],easein:[.42,0,1,1],easeout:[0,0,.58,1],easeinout:[.42,0,.58,1]},VCO.Ease={KeySpline:function(t){function e(t,e){return 1-3*e+3*t}function i(t,e){return 3*e-6*t}function n(t){return 3*t}function a(t,a,s){return((e(a,s)*t+i(a,s))*t+n(a))*t}function s(t,a,s){return 3*e(a,s)*t*t+2*i(a,s)*t+n(a)}function o(e){for(var i=e,n=0;4>n;++n){var o=s(i,t[0],t[2]);if(0==o)return i;var r=a(i,t[0],t[2])-e;i-=r/o}return i}this.get=function(e){return t[0]==t[1]&&t[2]==t[3]?e:a(o(e),t[1],t[3])}},easeInSpline:function(t){var e=new VCO.Ease.KeySpline(VCO.Easings.easein);return e.get(t)},easeInOutExpo:function(t){var e=new VCO.Ease.KeySpline(VCO.Easings.easein);return e.get(t)},easeOut:function(t){return Math.sin(t*Math.PI/2)},easeOutStrong:function(t){return 1==t?1:1-Math.pow(2,-10*t)},easeIn:function(t){return t*t},easeInStrong:function(t){return 0==t?0:Math.pow(2,10*(t-1))},easeOutBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},bounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bouncePast:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?2-(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?2-(7.5625*(t-=2.25/2.75)*t+.9375):2-(7.5625*(t-=2.625/2.75)*t+.984375)},swingTo:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},swingFrom:function(t){var e=1.70158;return t*t*((e+1)*t-e)},elastic:function(t){return-1*Math.pow(4,-8*t)*Math.sin(2*(6*t-1)*Math.PI/2)+1},spring:function(t){return 1-Math.cos(4.5*t*Math.PI)*Math.exp(6*-t)},blink:function(t,e){return Math.round(t*(e||5))%2},pulse:function(t,e){return-Math.cos(t*((e||5)-.5)*2*Math.PI)/2+.5},wobble:function(t){return-Math.cos(t*Math.PI*9*t)/2+.5},sinusoidal:function(t){return-Math.cos(t*Math.PI)/2+.5},flicker:function(t){var t=t+(Math.random()-.5)/5;return easings.sinusoidal(0>t?0:t>1?1:t)},mirror:function(t){return easings.sinusoidal(.5>t?2*t:1-2*(t-.5))},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return.5>t?2*t*t:-1+(4-2*t)*t},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return.5>t?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return.5>t?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return.5>t?16*t*t*t*t*t:1+16*--t*t*t*t*t}},VCO.Animate=function(t,e){var i=new vcoanimate(t,e),n;return i},window.vcoanimate=function(){function t(t,e,i){if(Array.prototype.indexOf)return t.indexOf(e);for(i=0;i<t.length;++i)if(t[i]===e)return i}function e(t){var i,n=I.length;for(C&&t>1e12&&(t=O()),w&&(t=O()),i=n;i--;)I[i](t);I.length&&P(e)}function i(t){1===I.push(t)&&P(e)}function n(e){var i,n=t(I,e);n>=0&&(i=I.slice(n+1),I.length=n,I=I.concat(i))}function a(t,e){var i={},n;return(n=t.match(D))&&(i.rotate=_(n[1],e?e.rotate:null)),(n=t.match(T))&&(i.scale=_(n[1],e?e.scale:null)),(n=t.match(E))&&(i.skewx=_(n[1],e?e.skewx:null),i.skewy=_(n[3],e?e.skewy:null)),(n=t.match(S))&&(i.translatex=_(n[1],e?e.translatex:null),i.translatey=_(n[3],e?e.translatey:null)),i}function s(t){var e="";return"rotate"in t&&(e+="rotate("+t.rotate+"deg) "),"scale"in t&&(e+="scale("+t.scale+") "),"translatex"in t&&(e+="translate("+t.translatex+"px,"+t.translatey+"px) "),"skewx"in t&&(e+="skew("+t.skewx+"deg,"+t.skewy+"deg)"),e}function o(t,e,i){return"#"+(1<<24|t<<16|e<<8|i).toString(16).slice(1)}function r(t){var e=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);return(e?o(e[1],e[2],e[3]):t).replace(/#(\w)(\w)(\w)$/,"#$1$1$2$2$3$3")}function h(t){return t.replace(/-(.)/g,function(t,e){return e.toUpperCase()})}function l(t){return"function"==typeof t}function c(t){return Math.sin(t*Math.PI/2)}function d(t,e,a,s,o,r){function h(t){var i=t-p;return i>d||_?(r=isFinite(r)?r:1,_?g&&e(r):e(r),n(h),a&&a.apply(u)):void e(isFinite(r)?m*s(i/d)+o:s(i/d))}s=l(s)?s:f.easings[s]||c;var d=t||b,u=this,m=r-o,p=O(),_=0,g=0;return i(h),{stop:function(t){_=1,g=t,t||(a=null)}}}function u(t,e){var i=t.length,n=[],a,s;for(a=0;i>a;++a)n[a]=[t[a][0],t[a][1]];for(s=1;i>s;++s)for(a=0;i-s>a;++a)n[a][0]=(1-e)*n[a][0]+e*n[parseInt(a+1,10)][0],n[a][1]=(1-e)*n[a][1]+e*n[parseInt(a+1,10)][1];return[n[0][0],n[0][1]]}function m(t,e,i){var n=[],a,s,o,r;for(a=0;6>a;a++)o=Math.min(15,parseInt(e.charAt(a),16)),r=Math.min(15,parseInt(i.charAt(a),16)),s=Math.floor((r-o)*t+o),s=s>15?15:0>s?0:s,n[a]=s.toString(16);return"#"+n.join("")}function p(t,e,i,n,a,s,o){if("transform"==a){o={};for(var r in i[s][a])o[r]=r in n[s][a]?Math.round(((n[s][a][r]-i[s][a][r])*t+i[s][a][r])*b)/b:i[s][a][r];return o}return"string"==typeof i[s][a]?m(t,i[s][a],n[s][a]):(o=Math.round(((n[s][a]-i[s][a])*t+i[s][a])*b)/b,a in L||(o+=e[s][a]||"px"),o)}function _(t,e,i,n,a){return(i=V.exec(t))?(a=parseFloat(i[2]))&&e+("+"==i[1]?1:-1)*a:parseFloat(t)}function f(t,e){var i=t?i=isFinite(t.length)?t:[t]:[],n,o=e.complete,c=e.duration,m=e.easing,f=e.bezier,g=[],v=[],y=[],C=[],O,x;for(f&&(O=e.left,x=e.top,delete e.right,delete e.bottom,delete e.left,delete e.top),n=i.length;n--;){if(g[n]={},v[n]={},y[n]={},f){var w=j(i[n],"left"),b=j(i[n],"top"),V=[_(l(O)?O(i[n]):O||0,parseFloat(w)),_(l(x)?x(i[n]):x||0,parseFloat(b))];C[n]=l(f)?f(i[n],V):f,C[n].push(V),C[n].unshift([parseInt(w,10),parseInt(b,10)])}for(var D in e){switch(D){case"complete":case"duration":case"easing":case"bezier":continue}var T=j(i[n],D),E,S=l(e[D])?e[D](i[n]):e[D];"string"!=typeof S||!k.test(S)||k.test(T)?(g[n][D]="transform"==D?a(T):"string"==typeof S&&k.test(S)?r(T).slice(1):parseFloat(T),v[n][D]="transform"==D?a(S,g[n][D]):"string"==typeof S&&"#"==S.charAt(0)?r(S).slice(1):_(S,parseFloat(T)),"string"==typeof S&&(E=S.match(M))&&(y[n][D]=E[1])):delete e[D]}}return d.apply(i,[c,function(t,a,o){for(n=i.length;n--;){f&&(o=u(C[n],t),i[n].style.left=o[0]+"px",i[n].style.top=o[1]+"px");for(var r in e)a=p(t,y,g,v,r,n),"transform"==r?i[n].style[A]=s(a):"opacity"!=r||N?i[n].style[h(r)]=a:i[n].style.filter="alpha(opacity="+100*a+")"}},o,m])}var g=document,v=window,y=v.performance,C=y&&(y.now||y.webkitNow||y.msNow||y.mozNow),O=C?function(){return C.call(y)}:function(){return+new Date},x=g.documentElement,w=!1,b=1e3,k=/^rgb\(|#/,V=/^([+\-])=([\d\.]+)/,M=/^(?:[\+\-]=?)?\d+(?:\.\d+)?(%|in|cm|mm|em|ex|pt|pc|px)$/,D=/rotate\(((?:[+\-]=)?([\-\d\.]+))deg\)/,T=/scale\(((?:[+\-]=)?([\d\.]+))\)/,E=/skew\(((?:[+\-]=)?([\-\d\.]+))deg, ?((?:[+\-]=)?([\-\d\.]+))deg\)/,S=/translate\(((?:[+\-]=)?([\-\d\.]+))px, ?((?:[+\-]=)?([\-\d\.]+))px\)/,L={lineHeight:1,zoom:1,zIndex:1,opacity:1,transform:1},A=function(){var t=g.createElement("a").style,e=["webkitTransform","MozTransform","OTransform","msTransform","Transform"],i;for(i=0;i<e.length;i++)if(e[i]in t)return e[i]}(),N=function(){return"undefined"!=typeof g.createElement("a").style.opacity}(),j=g.defaultView&&g.defaultView.getComputedStyle?function(t,e){e="transform"==e?A:e,e=h(e);var i=null,n=g.defaultView.getComputedStyle(t,"");return n&&(i=n[e]),t.style[e]||i}:x.currentStyle?function(t,e){if(e=h(e),"opacity"==e){var i=100;try{i=t.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(n){try{i=t.filters("alpha").opacity}catch(a){}}return i/100}var s=t.currentStyle?t.currentStyle[e]:null;return t.style[e]||s}:function(t,e){return t.style[h(e)]},P=function(){return v.requestAnimationFrame||v.webkitRequestAnimationFrame||v.mozRequestAnimationFrame||v.msRequestAnimationFrame||v.oRequestAnimationFrame||function(t){v.setTimeout(function(){t(+new Date)},17)}}(),I=[];return P(function(t){w=t>1e12!=O()>1e12}),f.tween=d,f.getStyle=j,f.bezier=u,f.transform=A,f.parseTransform=a,f.formatTransform=s,f.easings={},f}(),VCO.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},VCO.Point.prototype={add:function(t){return this.clone()._add(t)},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(t)},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t,e){return new VCO.Point(this.x/t,this.y/t,e)},multiplyBy:function(t){return new VCO.Point(this.x*t,this.y*t)},distanceTo:function(t){var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},clone:function(){return new VCO.Point(this.x,this.y)},toString:function(){return"Point("+VCO.Util.formatNum(this.x)+", "+VCO.Util.formatNum(this.y)+")"}},VCO.DomMixins={show:function(t){t||(this._el.container.style.display="block")},hide:function(t){this._el.container.style.display="none"},addTo:function(t){t.appendChild(this._el.container),this.onAdd()},removeFrom:function(t){t.removeChild(this._el.container),this.onRemove()},animatePosition:function(t,e){var i={duration:this.options.duration,easing:this.options.ease};for(var n in t)t.hasOwnProperty(n)&&(i[n]=t[n]+"px");this.animator&&this.animator.stop(),this.animator=VCO.Animate(e,i)},onLoaded:function(){this.fire("loaded",this.data)},onAdd:function(){this.fire("added",this.data)},onRemove:function(){this.fire("removed",this.data)},setPosition:function(t,e){for(var i in t)t.hasOwnProperty(i)&&(e?e.style[i]=t[i]+"px":this._el.container.style[i]=t[i]+"px")},getPosition:function(){return VCO.Dom.getPosition(this._el.container)}},VCO.Dom={get:function(t){return"string"==typeof t?document.getElementById(t):t},getByClass:function(t){return t?document.getElementsByClassName(t):void 0},create:function(t,e,i){var n=document.createElement(t);return n.className=e,i&&i.appendChild(n),n},createText:function(t,e){var i=document.createTextNode(t);return e&&e.appendChild(i),i},getTranslateString:function(t){return VCO.Dom.TRANSLATE_OPEN+t.x+"px,"+t.y+"px"+VCO.Dom.TRANSLATE_CLOSE},setPosition:function(t,e){t._vco_pos=e,VCO.Browser.webkit3d?(t.style[VCO.Dom.TRANSFORM]=VCO.Dom.getTranslateString(e),VCO.Browser.android&&(t.style["-webkit-perspective"]="1000",t.style["-webkit-backface-visibility"]="hidden")):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){for(var e={x:0,y:0};t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)e.x+=t.offsetLeft,e.y+=t.offsetTop,t=t.offsetParent;return e},testProp:function(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}},VCO.Util.extend(VCO.Dom,{TRANSITION:VCO.Dom.testProp(["transition","webkitTransition","OTransition","MozTransition","msTransition"]),TRANSFORM:VCO.Dom.testProp(["transformProperty","WebkitTransform","OTransform","MozTransform","msTransform"]),TRANSLATE_OPEN:"translate"+(VCO.Browser.webkit3d?"3d(":"("),TRANSLATE_CLOSE:VCO.Browser.webkit3d?",0)":")"}),VCO.DomUtil={get:function(t){return"string"==typeof t?document.getElementById(t):t},getStyle:function(t,e){var i=t.style[e];if(!i&&t.currentStyle&&(i=t.currentStyle[e]),!i||"auto"===i){var n=document.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i},getViewportOffset:function(t){var e=0,i=0,n=t,a=document.body;do{if(e+=n.offsetTop||0,i+=n.offsetLeft||0,n.offsetParent===a&&"absolute"===VCO.DomUtil.getStyle(n,"position"))break;n=n.offsetParent}while(n);n=t;do{if(n===a)break;e-=n.scrollTop||0,i-=n.scrollLeft||0,n=n.parentNode}while(n);return new VCO.Point(i,e)},create:function(t,e,i){var n=document.createElement(t);return n.className=e,i&&i.appendChild(n),n},disableTextSelection:function(){document.selection&&document.selection.empty&&document.selection.empty(),this._onselectstart||(this._onselectstart=document.onselectstart,document.onselectstart=VCO.Util.falseFn)},enableTextSelection:function(){document.onselectstart=this._onselectstart,this._onselectstart=null},hasClass:function(t,e){return t.className.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(t.className)},addClass:function(t,e){VCO.DomUtil.hasClass(t,e)||(t.className+=(t.className?" ":"")+e)},removeClass:function(t,e){t.className=t.className.replace(/(\S+)\s*/g,function(t,i){return i===e?"":t}).replace(/^\s+/,"")},setOpacity:function(t,e){VCO.Browser.ie?t.style.filter="alpha(opacity="+Math.round(100*e)+")":t.style.opacity=e},testProp:function(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1},getTranslateString:function(t){return VCO.DomUtil.TRANSLATE_OPEN+t.x+"px,"+t.y+"px"+VCO.DomUtil.TRANSLATE_CLOSE},getScaleString:function(t,e){var i=VCO.DomUtil.getTranslateString(e),n=" scale("+t+") ",a=VCO.DomUtil.getTranslateString(e.multiplyBy(-1));return i+n+a},setPosition:function(t,e){t._vco_pos=e,VCO.Browser.webkit3d?(t.style[VCO.DomUtil.TRANSFORM]=VCO.DomUtil.getTranslateString(e),VCO.Browser.android&&(t.style["-webkit-perspective"]="1000",t.style["-webkit-backface-visibility"]="hidden")):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._vco_pos}},VCO.DomEvent={addListener:function(t,e,i,n){var a=VCO.Util.stamp(i),s="_vco_"+e+a;if(!t[s]){var o=function(e){return i.call(n||t,e||VCO.DomEvent._getEvent())};if(VCO.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener)this.addDoubleTapListener(t,o,a);else if("addEventListener"in t)if("mousewheel"===e)t.addEventListener("DOMMouseScroll",o,!1),t.addEventListener(e,o,!1);else if("mouseenter"===e||"mouseleave"===e){var r=o,h="mouseenter"===e?"mouseover":"mouseout";o=function(e){return VCO.DomEvent._checkMouse(t,e)?r(e):void 0},t.addEventListener(h,o,!1)}else t.addEventListener(e,o,!1);else"attachEvent"in t&&t.attachEvent("on"+e,o);t[s]=o}},removeListener:function(t,e,i){var n=VCO.Util.stamp(i),a="_vco_"+e+n,s=t[a];s&&(VCO.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,n):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",s,!1),t.removeEventListener(e,s,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",s,!1):t.removeEventListener(e,s,!1):"detachEvent"in t&&t.detachEvent("on"+e,s),t[a]=null)},_checkMouse:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(n){return!1}return i!==t},_getEvent:function(){var t=window.event;if(!t)for(var e=arguments.callee.caller;e&&(t=e.arguments[0],!t||window.Event!==t.constructor);)e=e.caller;return t},stopPropagation:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},disableClickPropagation:function(t){VCO.DomEvent.addListener(t,VCO.Draggable.START,VCO.DomEvent.stopPropagation),VCO.DomEvent.addListener(t,"click",VCO.DomEvent.stopPropagation),VCO.DomEvent.addListener(t,"dblclick",VCO.DomEvent.stopPropagation)},preventDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},stop:function(t){VCO.DomEvent.preventDefault(t),VCO.DomEvent.stopPropagation(t)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e}},VCO.StyleSheet=VCO.Class.extend({includes:[VCO.Events],_el:{},initialize:function(){this.style=document.createElement("style"),this.style.appendChild(document.createTextNode("")),document.head.appendChild(this.style),this.sheet=this.style.sheet},addRule:function(t,e,i){var n=0;i&&(n=i),"insertRule"in this.sheet?this.sheet.insertRule(t+"{"+e+"}",n):"addRule"in this.sheet&&this.sheet.addRule(t,e,n)},onLoaded:function(t){this._state.loaded=!0,this.fire("loaded",this.data)}}),VCO.Date=VCO.Class.extend({initialize:function(t,e,i){"number"==typeof t?this.data={format:"yyyy mmmm",date_obj:new Date(t)}:Date==t.constructor?this.data={format:"yyyy mmmm",date_obj:t}:(this.data=t,this._createDateObj()),this._setFormat(e,i)},setDateFormat:function(t){this.data.format=t},getDisplayDate:function(t,e){return this.data.display_text?this.data.display_text:(t||(t=VCO.Language.fallback),t.constructor!=VCO.Language&&(trace("First argument to getDisplayDate must be VCO.Language"),t=VCO.Language.fallback),format_key=e||this.data.format,t.formatDate(this.data.date_obj,format_key))},getMillisecond:function(){return this.getTime()},getTime:function(){return this.data.date_obj.getTime()},isBefore:function(t){if(!this.data.date_obj.constructor==t.data.date_obj.constructor)throw"Can't compare VCO.Dates on different scales";return"isBefore"in this.data.date_obj?this.data.date_obj.isBefore(t.data.date_obj):this.data.date_obj<t.data.date_obj},isAfter:function(t){if(!this.data.date_obj.constructor==t.data.date_obj.constructor)throw"Can't compare VCO.Dates on different scales";return"isAfter"in this.data.date_obj?this.data.date_obj.isAfter(t.data.date_obj):this.data.date_obj>t.data.date_obj},floor:function(t){for(var e=new Date(this.data.date_obj),i=0;i<VCO.Date.SCALES.length;i++)if(VCO.Date.SCALES[i][2](e),VCO.Date.SCALES[i][0]==t)return new VCO.Date(e);throw"invalid scale "+t},_getDateData:function(){var t={year:0,month:1,day:1,hour:0,minute:0,second:0,millisecond:0};VCO.Util.mergeData(t,this.data),DATE_PARTS=VCO.Date.DATE_PARTS;for(var e in DATE_PARTS){var i=parseInt(t[DATE_PARTS[e]]);isNaN(i)&&(i=1==e||2==e?1:0),t[DATE_PARTS[e]]=i}return t.month>0&&t.month<=12&&(t.month=t.month-1),t},_createDateObj:function(){var t=this._getDateData();this.data.date_obj=new Date(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond)},_setFormat:function(t,e){t?this.data.format=t:this.data.format||(this.data.format=VCO.DateUtil.findBestFormat(this.data)),e?this.data.format_short=e:this.data.format_short||(this.data.format_short=VCO.DateUtil.findBestFormat(this.data,!0))}}),VCO.BigYear=VCO.Class.extend({initialize:function(t){if(this.year=parseInt(t),isNaN(this.year))throw"Invalid year "+t},isBefore:function(t){return this.year<t.year},isAfter:function(t){return this.year>t.year},getTime:function(){return this.year}}),function(t){t.SCALES=[["millisecond",1,function(t){}],["second",1e3,function(t){t.setMilliseconds(0)}],["minute",6e4,function(t){t.setSeconds(0)}],["hour",36e5,function(t){t.setMinutes(0)}],["day",864e5,function(t){t.setHours(0)}],["month",2592e6,function(t){t.setDate(1)}],["year",31536e6,function(t){t.setMonth(0)}],["decade",31536e7,function(t){var e=t.getFullYear();t.setFullYear(e-e%10)}],["century",31536e8,function(t){var e=t.getFullYear();t.setFullYear(e-e%100)}],["millennium",31536e9,function(t){var e=t.getFullYear();t.setFullYear(e-e%1e3)}]],t.DATE_PARTS=["millisecond","second","minute","hour","day","month","year"];var e=/^([\+-]?\d+?)(-\d{2}?)?(-\d{2}?)?$/,i=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/;t.parseISODate=function(t){var e=new Date(t);if(isNaN(e))throw"Invalid date: "+t;return{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}},t.parseDate=function(n){if(n.match(e)){var a=n.match(e).slice(1);return d={year:a[0].replace("+","")},a[1]&&(d.month=a[1].replace("-","")),a[2]&&(d.day=a[2].replace("-","")),d}if(n.match(i))return t.parseISODate(n);if(n.match(/^\-?\d+$/))return{year:n};var s={};if(n.match(/\d+\/\d+\/\d+/)){var o=n.match(/\d+\/\d+\/\d+/)[0];n=VCO.Util.trim(n.replace(o,""));var r=o.split("/");s.month=r[0],s.day=r[1],s.year=r[2]}if(n.match(/\d+\/\d+/)){var o=n.match(/\d+\/\d+/)[0];n=VCO.Util.trim(n.replace(o,""));var r=o.split("/");s.month=r[0],s.year=r[1]}if(n.match(":")){var h=n.split(":");s.hour=h[0],s.minute=h[1],h[2]&&(second_parts=h[2].split("."),s.second=second_parts[0],s.millisecond=second_parts[1])}return s}}(VCO.Date),VCO.BigDate=VCO.Date.extend({initialize:function(t,e,i){VCO.BigYear==t.constructor?this.data={date_obj:t}:(this.data=t,this._createDateObj()),this._setFormat(e,i)},_createDateObj:function(){var t=this._getDateData();this.data.date_obj=new VCO.BigYear(t.year)},floor:function(t){for(var e=0;e<VCO.BigDate.SCALES.length;e++)if(VCO.BigDate.SCALES[e][0]==t){var i=VCO.BigDate.SCALES[e][2](this.data.date_obj);return new VCO.BigDate(i)}throw"invalid scale "+t}}),function(t){var e=1e6,i=10*e,n=10*i,a=10*n,s=function(t){return function(e){var i=e.getTime();return new VCO.BigYear(Math.floor(i/t)*t)}};t.SCALES=[["age",e,new s(e)],["epoch",i,new s(i)],["era",n,new s(n)],["eon",a,new s(a)]]}(VCO.BigDate),VCO.DateUtil={get:function(t){return"string"==typeof t?document.getElementById(t):t},sortByDate:function(t,e){var e=e||"start_date";t.sort(function(t,i){return t[e].isBefore(i[e])?-1:t[e].isAfter(i[e])?1:0})},findBestFormat:function(t,e){for(var i=VCO.Date.DATE_PARTS,n="",a=0;a<i.length;a++)if(t[i[a]])return e?e in VCO.DateUtil.best_dateformats||(e="short"):e="base",VCO.DateUtil.best_dateformats[e][i[a]];return""},best_dateformats:{base:{millisecond:1,second:"time",minute:"time_no_seconds_small_date",hour:"time_no_seconds_small_date",day:"full",month:"month",year:"year",decade:"year",century:"year",millennium:"year",age:"fallback",epoch:"fallback",era:"fallback",eon:"fallback",eon2:"fallback"},"short":{millisecond:1,second:"time_short",minute:"time_no_seconds_short",hour:"time_no_minutes_short",day:"full_short",month:"month_short",year:"year",decade:"year",century:"year",millennium:"year",age:"fallback",epoch:"fallback",era:"fallback",eon:"fallback",eon2:"fallback"}}},VCO.Draggable=VCO.Class.extend({includes:VCO.Events,_el:{},mousedrag:{down:"mousedown",up:"mouseup",leave:"mouseleave",move:"mousemove"},touchdrag:{down:"touchstart",up:"touchend",leave:"mouseleave",move:"touchmove"},initialize:function(t,e,i){this._el={drag:t,move:t},i&&(this._el.move=i),this.options={enable:{x:!0,y:!0},constraint:{top:!1,bottom:!1,left:!1,right:!1},momentum_multiplier:2e3,duration:1e3,ease:VCO.Ease.easeInOutQuint},this.animator=null,this.dragevent=this.mousedrag,VCO.Browser.touch&&(this.dragevent=this.touchdrag),this.data={sliding:!1,direction:"none",pagex:{start:0,end:0},pagey:{start:0,end:0},pos:{start:{x:0,y:0},end:{x:0,y:0}},new_pos:{x:0,y:0},new_pos_parent:{x:0,y:0},time:{start:0,end:0},touch:!1},VCO.Util.mergeData(this.options,e)
},enable:function(t){this.data.pos.start=0,this._el.move.style.left=this.data.pos.start.x+"px",this._el.move.style.top=this.data.pos.start.y+"px",this._el.move.style.position="absolute"},disable:function(){VCO.DomEvent.removeListener(this._el.drag,this.dragevent.down,this._onDragStart,this),VCO.DomEvent.removeListener(this._el.drag,this.dragevent.up,this._onDragEnd,this)},stopMomentum:function(){this.animator&&this.animator.stop()},updateConstraint:function(t){this.options.constraint=t},_onDragStart:function(t){VCO.Browser.touch?t.originalEvent?(this.data.pagex.start=t.originalEvent.touches[0].screenX,this.data.pagey.start=t.originalEvent.touches[0].screenY):(this.data.pagex.start=t.targetTouches[0].screenX,this.data.pagey.start=t.targetTouches[0].screenY):(this.data.pagex.start=t.pageX,this.data.pagey.start=t.pageY),this.options.enable.x&&(this._el.move.style.left=this.data.pagex.start-this._el.move.offsetWidth/2+"px"),this.options.enable.y&&(this._el.move.style.top=this.data.pagey.start-this._el.move.offsetHeight/2+"px"),this.data.pos.start=VCO.Dom.getPosition(this._el.drag),this.data.time.start=(new Date).getTime(),this.fire("dragstart",this.data),VCO.DomEvent.addListener(this._el.drag,this.dragevent.move,this._onDragMove,this),VCO.DomEvent.addListener(this._el.drag,this.dragevent.leave,this._onDragEnd,this)},_onDragEnd:function(t){this.data.sliding=!1,VCO.DomEvent.removeListener(this._el.drag,this.dragevent.move,this._onDragMove,this),VCO.DomEvent.removeListener(this._el.drag,this.dragevent.leave,this._onDragEnd,this),this.fire("dragend",this.data),this._momentum()},_onDragMove:function(t){t.preventDefault(),this.data.sliding=!0,VCO.Browser.touch?t.originalEvent?(this.data.pagex.end=t.originalEvent.touches[0].screenX,this.data.pagey.end=t.originalEvent.touches[0].screenY):(this.data.pagex.end=t.targetTouches[0].screenX,this.data.pagey.end=t.targetTouches[0].screenY):(this.data.pagex.end=t.pageX,this.data.pagey.end=t.pageY),this.data.pos.end=VCO.Dom.getPosition(this._el.drag),this.data.new_pos.x=-(this.data.pagex.start-this.data.pagex.end-this.data.pos.start.x),this.data.new_pos.y=-(this.data.pagey.start-this.data.pagey.end-this.data.pos.start.y),this.options.enable.x&&(this._el.move.style.left=this.data.new_pos.x+"px"),this.options.enable.y&&(this._el.move.style.top=this.data.new_pos.y+"px"),this.fire("dragmove",this.data)},_momentum:function(){var t={x:0,y:0,time:0},e={x:0,y:0,time:0},i=!1,n="";VCO.Browser.touch,t.time=10*((new Date).getTime()-this.data.time.start),e.time=10*((new Date).getTime()-this.data.time.start),e.x=this.options.momentum_multiplier*(Math.abs(this.data.pagex.end)-Math.abs(this.data.pagex.start)),e.y=this.options.momentum_multiplier*(Math.abs(this.data.pagey.end)-Math.abs(this.data.pagey.start)),t.x=Math.round(e.x/e.time),t.y=Math.round(e.y/e.time),this.data.new_pos.x=Math.min(this.data.pos.end.x+t.x),this.data.new_pos.y=Math.min(this.data.pos.end.y+t.y),this.options.enable.x?this.data.new_pos.x<0&&(this.data.new_pos.x=0):this.data.new_pos.x=this.data.pos.start.x,this.options.enable.y?this.data.new_pos.y<0&&(this.data.new_pos.y=0):this.data.new_pos.y=this.data.pos.start.y,e.time<3e3&&(i=!0),Math.abs(e.x)>1e4&&(this.data.direction="left",e.x>0&&(this.data.direction="right")),Math.abs(e.y)>1e4&&(this.data.direction="up",e.y>0&&(this.data.direction="down")),this._animateMomentum(),i&&this.fire("swipe_"+this.data.direction,this.data)},_animateMomentum:function(){var t={x:this.data.new_pos.x,y:this.data.new_pos.y},e={duration:this.options.duration,easing:VCO.Ease.easeOutStrong};this.options.enable.y&&((this.options.constraint.top||this.options.constraint.bottom)&&(t.y>this.options.constraint.bottom?t.y=this.options.constraint.bottom:t.y<this.options.constraint.top&&(t.y=this.options.constraint.top)),e.top=Math.floor(t.y)+"px"),this.options.enable.x&&((this.options.constraint.left||this.options.constraint.right)&&(t.x>this.options.constraint.left?t.x=this.options.constraint.left:t.x<this.options.constraint.right&&(t.x=this.options.constraint.right)),e.left=Math.floor(t.x)+"px"),this.animator=VCO.Animate(this._el.move,e),this.fire("momentum",this.data)}}),VCO.Swipable=VCO.Class.extend({includes:VCO.Events,_el:{},mousedrag:{down:"mousedown",up:"mouseup",leave:"mouseleave",move:"mousemove"},touchdrag:{down:"touchstart",up:"touchend",leave:"mouseleave",move:"touchmove"},initialize:function(t,e,i){this._el={drag:t,move:t},e&&(this._el.move=e),this.options={snap:!1,enable:{x:!0,y:!0},constraint:{top:!1,bottom:!1,left:0,right:!1},momentum_multiplier:2e3,duration:1e3,ease:VCO.Ease.easeInOutQuint},this.animator=null,this.dragevent=this.mousedrag,VCO.Browser.touch&&(this.dragevent=this.touchdrag),this.data={sliding:!1,direction:"none",pagex:{start:0,end:0},pagey:{start:0,end:0},pos:{start:{x:0,y:0},end:{x:0,y:0}},new_pos:{x:0,y:0},new_pos_parent:{x:0,y:0},time:{start:0,end:0},touch:!1},VCO.Util.mergeData(this.options,i)},enable:function(t){VCO.DomEvent.addListener(this._el.drag,this.dragevent.down,this._onDragStart,this),VCO.DomEvent.addListener(this._el.drag,this.dragevent.up,this._onDragEnd,this),this.data.pos.start=0,this._el.move.style.left=this.data.pos.start.x+"px",this._el.move.style.top=this.data.pos.start.y+"px",this._el.move.style.position="absolute"},disable:function(){VCO.DomEvent.removeListener(this._el.drag,this.dragevent.down,this._onDragStart,this),VCO.DomEvent.removeListener(this._el.drag,this.dragevent.up,this._onDragEnd,this)},stopMomentum:function(){this.animator&&this.animator.stop()},updateConstraint:function(t){this.options.constraint=t},_onDragStart:function(t){this.animator&&this.animator.stop(),VCO.Browser.touch?t.originalEvent?(this.data.pagex.start=t.originalEvent.touches[0].screenX,this.data.pagey.start=t.originalEvent.touches[0].screenY):(this.data.pagex.start=t.targetTouches[0].screenX,this.data.pagey.start=t.targetTouches[0].screenY):(this.data.pagex.start=t.pageX,this.data.pagey.start=t.pageY),this.options.enable.x,this.options.enable.y,this.data.pos.start={x:this._el.move.offsetLeft,y:this._el.move.offsetTop},this.data.time.start=(new Date).getTime(),this.fire("dragstart",this.data),VCO.DomEvent.addListener(this._el.drag,this.dragevent.move,this._onDragMove,this),VCO.DomEvent.addListener(this._el.drag,this.dragevent.leave,this._onDragEnd,this)},_onDragEnd:function(t){this.data.sliding=!1,VCO.DomEvent.removeListener(this._el.drag,this.dragevent.move,this._onDragMove,this),VCO.DomEvent.removeListener(this._el.drag,this.dragevent.leave,this._onDragEnd,this),this.fire("dragend",this.data),this._momentum()},_onDragMove:function(t){var e={x:0,y:0};this.data.sliding=!0,VCO.Browser.touch?t.originalEvent?(this.data.pagex.end=t.originalEvent.touches[0].screenX,this.data.pagey.end=t.originalEvent.touches[0].screenY):(this.data.pagex.end=t.targetTouches[0].screenX,this.data.pagey.end=t.targetTouches[0].screenY):(this.data.pagex.end=t.pageX,this.data.pagey.end=t.pageY),e.x=this.data.pagex.start-this.data.pagex.end,e.y=this.data.pagey.start-this.data.pagey.end,this.data.pos.end={x:this._el.drag.offsetLeft,y:this._el.drag.offsetTop},this.data.new_pos.x=-(e.x-this.data.pos.start.x),this.data.new_pos.y=-(e.y-this.data.pos.start.y),this.options.enable.x&&Math.abs(e.x)>Math.abs(e.y)&&(t.preventDefault(),this._el.move.style.left=this.data.new_pos.x+"px"),this.options.enable.y&&Math.abs(e.y)>Math.abs(e.y)&&(t.preventDefault(),this._el.move.style.top=this.data.new_pos.y+"px"),this.fire("dragmove",this.data)},_momentum:function(){var t={x:0,y:0,time:0},e={x:0,y:0,time:0},i={x:!1,y:!1},n=!1,a="";this.data.direction=null,t.time=10*((new Date).getTime()-this.data.time.start),e.time=10*((new Date).getTime()-this.data.time.start),e.x=this.options.momentum_multiplier*(Math.abs(this.data.pagex.end)-Math.abs(this.data.pagex.start)),e.y=this.options.momentum_multiplier*(Math.abs(this.data.pagey.end)-Math.abs(this.data.pagey.start)),t.x=Math.round(e.x/e.time),t.y=Math.round(e.y/e.time),this.data.new_pos.x=Math.min(this.data.new_pos.x+t.x),this.data.new_pos.y=Math.min(this.data.new_pos.y+t.y),this.options.enable.x?this.options.constraint.left&&this.data.new_pos.x>this.options.constraint.left&&(this.data.new_pos.x=this.options.constraint.left):this.data.new_pos.x=this.data.pos.start.x,this.options.enable.y?this.data.new_pos.y<0&&(this.data.new_pos.y=0):this.data.new_pos.y=this.data.pos.start.y,e.time<2e3&&(n=!0),this.options.enable.x&&this.options.enable.y?Math.abs(e.x)>Math.abs(e.y)?i.x=!0:i.y=!0:this.options.enable.x?Math.abs(e.x)>Math.abs(e.y)&&(i.x=!0):Math.abs(e.y)>Math.abs(e.x)&&(i.y=!0),i.x&&(Math.abs(e.x)>this._el.drag.offsetWidth/2&&(n=!0),Math.abs(e.x)>1e4&&(this.data.direction="left",e.x>0&&(this.data.direction="right"))),i.y&&(Math.abs(e.y)>this._el.drag.offsetHeight/2&&(n=!0),Math.abs(e.y)>1e4&&(this.data.direction="up",e.y>0&&(this.data.direction="down"))),e.time<1e3||this._animateMomentum(),n&&this.data.direction?this.fire("swipe_"+this.data.direction,this.data):this.data.direction?this.fire("swipe_nodirection",this.data):this.options.snap&&(this.animator.stop(),this.animator=VCO.Animate(this._el.move,{top:this.data.pos.start.y,left:this.data.pos.start.x,duration:this.options.duration,easing:VCO.Ease.easeOutStrong}))},_animateMomentum:function(){var t={x:this.data.new_pos.x,y:this.data.new_pos.y},e={duration:this.options.duration,easing:VCO.Ease.easeOutStrong};this.options.enable.y&&((this.options.constraint.top||this.options.constraint.bottom)&&(t.y>this.options.constraint.bottom?t.y=this.options.constraint.bottom:t.y<this.options.constraint.top&&(t.y=this.options.constraint.top)),e.top=Math.floor(t.y)+"px"),this.options.enable.x&&(this.options.constraint.left&&t.x>=this.options.constraint.left&&(t.x=this.options.constraint.left),this.options.constraint.right&&t.x<this.options.constraint.right&&(t.x=this.options.constraint.right),e.left=Math.floor(t.x)+"px"),this.animator=VCO.Animate(this._el.move,e),this.fire("momentum",this.data)}}),VCO.MenuBar=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins],_el:{},initialize:function(t,e,i){this._el={parent:{},container:{},button_backtostart:{},button_zoomin:{},button_zoomout:{},arrow:{},line:{},coverbar:{},grip:{}},this.collapsed=!1,this._el.container="object"==typeof t?t:VCO.Dom.get(t),e&&(this._el.parent=e),this.options={width:600,height:600,duration:1e3,ease:VCO.Ease.easeInOutQuint,menubar_default_y:0},this.animator={},VCO.Util.mergeData(this.options,i),this._initLayout(),this._initEvents()},show:function(t){var e=this.options.duration;t&&(e=t)},hide:function(t){},setSticky:function(t){this.options.menubar_default_y=t},setColor:function(t){this._el.container.className=t?"vco-menubar vco-menubar-inverted":"vco-menubar"},updateDisplay:function(t,e,i,n){this._updateDisplay(t,e,i,n)},_onButtonZoomIn:function(t){this.fire("zoom_in",t)},_onButtonZoomOut:function(t){this.fire("zoom_out",t)},_onButtonBackToStart:function(t){this.fire("back_to_start",t)},_initLayout:function(){this._el.button_zoomin=VCO.Dom.create("span","vco-menubar-button",this._el.container),this._el.button_zoomout=VCO.Dom.create("span","vco-menubar-button",this._el.container),this._el.button_backtostart=VCO.Dom.create("span","vco-menubar-button",this._el.container),VCO.Browser.mobile&&this._el.container.setAttribute("ontouchstart"," "),this._el.button_backtostart.innerHTML="<span class='vco-icon-goback'></span>",this._el.button_zoomin.innerHTML="<span class='vco-icon-zoom-in'></span>",this._el.button_zoomout.innerHTML="<span class='vco-icon-zoom-out'></span>"},_initEvents:function(){VCO.DomEvent.addListener(this._el.button_backtostart,"click",this._onButtonBackToStart,this),VCO.DomEvent.addListener(this._el.button_zoomin,"click",this._onButtonZoomIn,this),VCO.DomEvent.addListener(this._el.button_zoomout,"click",this._onButtonZoomOut,this)},_updateDisplay:function(t,e,i){t&&(this.options.width=t),e&&(this.options.height=e)}}),VCO.Message=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins],_el:{},initialize:function(t,e,i){this._el={parent:{},container:{},message_container:{},loading_icon:{},message:{}},this.options={width:600,height:600,message_class:"vco-message",message_icon_class:"vco-loading-icon"},VCO.Util.mergeData(this.data,t),VCO.Util.mergeData(this.options,e),this._el.container=VCO.Dom.create("div",this.options.message_class),i&&(i.appendChild(this._el.container),this._el.parent=i),this.animator={},this._initLayout(),this._initEvents()},updateMessage:function(t){this._updateMessage(t)},updateDisplay:function(t,e){this._updateDisplay(t,e)},_updateMessage:function(t){if(t)this._el.message.innerHTML=t;else{var e=this.options.language||VCO.Language.fallback;this._el.message.innerHTML=e._("loading")}},_onMouseClick:function(){this.fire("clicked",this.options)},_initLayout:function(){this._el.message_container=VCO.Dom.create("div","vco-message-container",this._el.container),this._el.loading_icon=VCO.Dom.create("div",this.options.message_icon_class,this._el.message_container),this._el.message=VCO.Dom.create("div","vco-message-content",this._el.message_container),this._updateMessage()},_initEvents:function(){VCO.DomEvent.addListener(this._el.container,"click",this._onMouseClick,this)},_updateDisplay:function(t,e,i){}}),VCO.MediaType=function(t){for(var e={},i=[{type:"youtube",name:"YouTube",match_str:"(www.)?youtube|youtu.be",cls:VCO.Media.YouTube},{type:"vimeo",name:"Vimeo",match_str:"(player.)?vimeo.com",cls:VCO.Media.Vimeo},{type:"dailymotion",name:"DailyMotion",match_str:"(www.)?dailymotion.com",cls:VCO.Media.DailyMotion},{type:"vine",name:"Vine",match_str:"(www.)?vine.co",cls:VCO.Media.Vine},{type:"soundcloud",name:"SoundCloud",match_str:"(player.)?soundcloud.com",cls:VCO.Media.SoundCloud},{type:"twitter",name:"Twitter",match_str:"(www.)?twitter.com",cls:VCO.Media.Twitter},{type:"googlemaps",name:"Google Map",match_str:"maps.google",cls:VCO.Media.Map},{type:"googleplus",name:"Google+",match_str:"plus.google",cls:VCO.Media.GooglePlus},{type:"flickr",name:"Flickr",match_str:"flickr.com/photos",cls:VCO.Media.Flickr},{type:"instagram",name:"Instagram",match_str:/(instagr.am|instagram.com)\/p\//,cls:VCO.Media.Instagram},{type:"profile",name:"Profile",match_str:/((instagr.am|instagram.com)(\/profiles\/|[-a-zA-Z0-9@:%_\+.~#?&//=]+instagramprofile))|[-a-zA-Z0-9@:%_\+.~#?&//=]+\?profile/,cls:VCO.Media.Profile},{type:"image",name:"Image",match_str:/jpg|jpeg|png|gif/i,cls:VCO.Media.Image},{type:"googledocs",name:"Google Doc",match_str:/\b.(doc|docx|xls|xlsx|ppt|pptx|pdf|pages|ai|psd|tiff|dxf|svg|eps|ps|ttf|xps|zip|tif)\b/,cls:VCO.Media.GoogleDoc},{type:"wikipedia",name:"Wikipedia",match_str:"(www.)?wikipedia.org",cls:VCO.Media.Wikipedia},{type:"spotify",name:"spotify",match_str:"spotify",cls:VCO.Media.Spotify},{type:"iframe",name:"iFrame",match_str:"iframe",cls:VCO.Media.IFrame},{type:"storify",name:"Storify",match_str:"storify",cls:VCO.Media.Storify},{type:"blockquote",name:"Quote",match_str:"blockquote",cls:VCO.Media.Blockquote},{type:"website",name:"Website",match_str:"http://",cls:VCO.Media.Website},{type:"image",name:"Image",match_str:"",cls:VCO.Media.Image}],n=0;n<i.length;n++){if(t instanceof Array)return e={type:"slider",cls:VCO.Media.Slider};if(t.url.match(i[n].match_str)){return e=i[n],e.url=t.url,e;break}}return!1},VCO.Media=VCO.Class.extend({includes:[VCO.Events,VCO.I18NMixins],_el:{},initialize:function(t,e,i){this._el={container:{},content_container:{},content:{},content_item:{},content_link:{},caption:null,credit:null,parent:{},link:null},this.player=null,this.timer=null,this.load_timer=null,this.message=null,this.media_id=null,this._state={loaded:!1,show_meta:!1,media_loaded:!1},this.data={uniqueid:null,url:null,credit:null,caption:null,link:null,link_target:null},this.options={api_key_flickr:"f2cc870b4d233dd0a5bfe73fd0d64ef0",credit_height:0,caption_height:0},this.animator={},VCO.Util.mergeData(this.options,e),VCO.Util.mergeData(this.data,t),this._el.container=VCO.Dom.create("div","vco-media"),this.data.uniqueid&&(this._el.container.id=this.data.uniqueid),this._initLayout(),i&&(i.appendChild(this._el.container),this._el.parent=i)},loadMedia:function(){var t=this;if(!this._state.loaded)try{this.load_timer=setTimeout(function(){t._loadMedia(),t._state.loaded=!0,t._updateDisplay()},1200)}catch(e){trace("Error loading media for ",this._media),trace(e)}},loadingMessage:function(){this.message.updateMessage(this._("loading")+" "+this.options.media_name)},updateMediaDisplay:function(t){this._state.loaded&&(this._el.content_item.style.maxHeight=VCO.Browser.mobile?this.options.height/2+"px":this.options.height-this.options.credit_height-this.options.caption_height-30+"px",this._el.container.style.maxWidth=this.options.width+"px",VCO.Browser.firefox&&this._el.content_item.offsetWidth>this._el.content_item.offsetHeight,this._updateMediaDisplay(t),this._state.media_loaded&&(this._el.credit&&(this._el.credit.style.width=this._el.content_item.offsetWidth+"px"),this._el.caption&&(this._el.caption.style.width=this._el.content_item.offsetWidth+"px")))},_loadMedia:function(){},_updateMediaDisplay:function(t){VCO.Browser.firefox&&(this._el.content_item.style.maxWidth=this.options.width+"px",this._el.content_item.style.width="auto")},show:function(){},hide:function(){},addTo:function(t){t.appendChild(this._el.container),this.onAdd()},removeFrom:function(t){t.removeChild(this._el.container),this.onRemove()},updateDisplay:function(t,e,i){this._updateDisplay(t,e,i)},stopMedia:function(){this._stopMedia()},loadErrorDisplay:function(t){this._el.content.removeChild(this._el.content_item),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-loaderror",this._el.content),this._el.content_item.innerHTML="<div class='vco-icon-"+this.options.media_type+"'></div><p>"+t+"</p>",this.onLoaded(!0)},onLoaded:function(t){this._state.loaded=!0,this.fire("loaded",this.data),this.message&&this.message.hide(),t||this.showMeta(),this.updateDisplay()},onMediaLoaded:function(t){this._state.media_loaded=!0,this.fire("media_loaded",this.data),this._el.credit&&(this._el.credit.style.width=this._el.content_item.offsetWidth+"px"),this._el.caption&&(this._el.caption.style.width=this._el.content_item.offsetWidth+"px")},showMeta:function(t,e){this._state.show_meta=!0,this.data.credit&&""!=this.data.credit&&(this._el.credit=VCO.Dom.create("div","vco-credit",this._el.content_container),this._el.credit.innerHTML=this.data.credit,this.options.credit_height=this._el.credit.offsetHeight),this.data.caption&&""!=this.data.caption&&(this._el.caption=VCO.Dom.create("div","vco-caption",this._el.content_container),this._el.caption.innerHTML=this.data.caption,this.options.caption_height=this._el.caption.offsetHeight)},onAdd:function(){this.fire("added",this.data)},onRemove:function(){this.fire("removed",this.data)},_initLayout:function(){this.message=new VCO.Message({},this.options),this.message.addTo(this._el.container),this._el.content_container=VCO.Dom.create("div","vco-media-content-container",this._el.container),this.data.link&&""!=this.data.link?(this._el.link=VCO.Dom.create("a","vco-media-link",this._el.content_container),this._el.link.href=this.data.link,this._el.link.target=this.data.link_target&&""!=this.data.link_target?this.data.link_target:"_blank",this._el.content=VCO.Dom.create("div","vco-media-content",this._el.link)):this._el.content=VCO.Dom.create("div","vco-media-content",this._el.content_container)},_updateDisplay:function(t,e,i){t&&(this.options.width=t),e&&(this.options.height=e),i&&(this.options.layout=i),this._el.credit&&(this.options.credit_height=this._el.credit.offsetHeight),this._el.caption&&(this.options.caption_height=this._el.caption.offsetHeight+5),this.updateMediaDisplay(this.options.layout)},_stopMedia:function(){}}),VCO.Media.Blockquote=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-blockquote",this._el.content),this._el.content_container.className="vco-media-content-container vco-media-content-container-text",this.media_id=this.data.url,this._el.content_item.innerHTML=this.media_id,this.onLoaded()},updateMediaDisplay:function(){},_updateMediaDisplay:function(){}}),VCO.Media.Flickr=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this._el.content_link=VCO.Dom.create("a","",this._el.content),this._el.content_link.href=this.data.url,this._el.content_link.target="_blank",this._el.content_item=VCO.Dom.create("img","vco-media-item vco-media-image vco-media-flickr vco-media-shadow",this._el.content_link),this._el.content_item.addEventListener("load",function(t){e.onMediaLoaded()}),this.establishMediaID(),t="https://api.flickr.com/services/rest/?method=flickr.photos.getSizes&api_key="+this.options.api_key_flickr+"&photo_id="+this.media_id+"&format=json&jsoncallback=?",VCO.getJSON(t,function(t){"ok"==t.stat?e.createMedia(t):e.loadErrorDisplay("Photo not found or private.")})},establishMediaID:function(){var t="flickr.com/photos/",e=this.data.url.indexOf(t);if(-1==e)throw"Invalid Flickr URL";var i=e+t.length;this.media_id=this.data.url.substr(i).split("/")[1]},createMedia:function(t){var e=this.sizes(this.options.height),i=t.sizes.size[t.sizes.size.length-2].source;self=this;for(var n=0;n<t.sizes.size.length;n++)t.sizes.size[n].label==e&&(i=t.sizes.size[n].source);this._el.content_item.src=i,this.onLoaded()},sizes:function(t){var e="";return e=75>=t?0>=t?"Large":"Thumbnail":180>=t?"Small":240>=t?"Small 320":375>=t?"Medium":480>=t?"Medium 640":600>=t?"Large":"Large"}}),VCO.Media.Instagram=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this.media_id=this.data.url.split("/p/")[1].split("/")[0],this._el.content_link=VCO.Dom.create("a","",this._el.content),this._el.content_link.href=this.data.url,this._el.content_link.target="_blank",this._el.content_item=VCO.Dom.create("img","vco-media-item vco-media-image vco-media-instagram vco-media-shadow",this._el.content_link),this._el.content_item.addEventListener("load",function(t){e.onMediaLoaded()}),this._el.content_item.src="http://instagr.am/p/"+this.media_id+"/media/?size="+this.sizes(this._el.content.offsetWidth),this.onLoaded()},sizes:function(t){var e="";return e=150>=t?"t":306>=t?"m":"l"}}),VCO.Media.Profile=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){this.loadingMessage(),this._el.content_item=VCO.Dom.create("img","vco-media-item vco-media-image vco-media-profile vco-media-shadow",this._el.content),this._el.content_item.src=this.data.url,this.onLoaded()},_updateMediaDisplay:function(t){VCO.Browser.firefox&&(this._el.content_item.style.maxWidth=this.options.width/2-40+"px")}}),VCO.Media.GoogleDoc=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe",this._el.content),this.media_id=this.data.url,t=this.media_id,this._el.content_item.innerHTML=this.media_id.match(/docs.google.com/i)?"<iframe class='doc' frameborder='0' width='100%' height='100%' src='"+this.media_id+"&amp;embedded=true'></iframe>":"<iframe class='doc' frameborder='0' width='100%' height='100%' src='http://docs.google.com/viewer?url="+this.media_id+"&amp;embedded=true'></iframe>",this.onLoaded()},_updateMediaDisplay:function(){this._el.content_item.style.height=this.options.height+"px"}}),VCO.Media.GooglePlus=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-googleplus",this._el.content),this.media_id=this.data.url,t=this.media_id,this._el.content_item.innerHTML="<iframe frameborder='0' width='100%' height='100%' src='"+t+"'></iframe>",this.onLoaded()},_updateMediaDisplay:function(){this._el.content_item.style.height=this.options.height+"px"}}),VCO.Media.IFrame=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe",this._el.content),this.media_id=this.data.url,t=this.media_id,this._el.content_item.innerHTML=t,this.onLoaded()},_updateMediaDisplay:function(){this._el.content_item.style.height=this.options.height+"px"}}),VCO.Media.Image=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t=this;this.loadingMessage(),this.data.link?(this._el.content_link=VCO.Dom.create("a","",this._el.content),this._el.content_link.href=this.data.link,this._el.content_link.target="_blank",this._el.content_item=VCO.Dom.create("img","vco-media-item vco-media-image vco-media-shadow",this._el.content_link)):this._el.content_item=VCO.Dom.create("img","vco-media-item vco-media-image vco-media-shadow",this._el.content),this._el.content_item.addEventListener("load",function(e){t.onMediaLoaded()}),this._el.content_item.src=this.data.url,this.onLoaded()},_updateMediaDisplay:function(t){VCO.Browser.firefox&&(this._el.content_item.style.width="auto")}}),VCO.Media.SoundCloud=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe vco-media-soundcloud vco-media-shadow",this._el.content),this.media_id=this.data.url,t="http://soundcloud.com/oembed?url="+this.media_id+"&format=js&callback=?",VCO.getJSON(t,function(t){e.createMedia(t)})},createMedia:function(t){this._el.content_item.innerHTML=t.html,this.onLoaded()}}),VCO.Media.Storify=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe vco-media-storify",this._el.content),this.media_id=this.data.url,t="<iframe frameborder='0' width='100%' height='100%' src='"+this.media_id+"/embed'></iframe>",t+="<script src='"+this.media_id+".js'></script>",this._el.content_item.innerHTML=t,this.onLoaded()},_updateMediaDisplay:function(){this._el.content_item.style.height=this.options.height+"px"}}),VCO.Media.Text=VCO.Class.extend({includes:[VCO.Events],_el:{container:{},content_container:{},content:{},headline:{},date:{}},data:{uniqueid:"",headline:"headline",text:"text"},options:{title:!1},initialize:function(t,e,i){VCO.Util.setData(this,t),VCO.Util.mergeData(this.options,e),this._el.container=VCO.Dom.create("div","vco-text"),this._el.container.id=this.data.uniqueid,this._initLayout(),i&&i.appendChild(this._el.container)},show:function(){},hide:function(){},addTo:function(t){t.appendChild(this._el.container)},removeFrom:function(t){t.removeChild(this._el.container)},headlineHeight:function(){return this._el.headline.offsetHeight+40},addDateText:function(t){this._el.date.innerHTML=t},onLoaded:function(){this.fire("loaded",this.data)},onAdd:function(){this.fire("added",this.data)},onRemove:function(){this.fire("removed",this.data)},_initLayout:function(){if(this._el.content_container=VCO.Dom.create("div","vco-text-content-container",this._el.container),this._el.date=VCO.Dom.create("h3","vco-headline-date",this._el.content_container),""!=this.data.headline){var t="vco-headline";this.options.title&&(t="vco-headline vco-headline-title"),this._el.headline=VCO.Dom.create("h2",t,this._el.content_container),this._el.headline.innerHTML=this.data.headline}if(""!=this.data.text){var e="";e+=VCO.Util.htmlify(this.data.text),this._el.content=VCO.Dom.create("div","vco-text-content",this._el.content_container),this._el.content.innerHTML=e}this.onLoaded()}}),VCO.Media.Twitter=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-twitter",this._el.content),this._el.content_container.className="vco-media-content-container vco-media-content-container-text",this.media_id=this.data.url.match("status/")?this.data.url.split("status/")[1]:url.match("statuses/")?this.data.url.split("statuses/")[1]:"",t="https://api.twitter.com/1/statuses/oembed.json?id="+this.media_id+"&omit_script=true&include_entities=true&callback=?",VCO.ajax({type:"GET",url:t,dataType:"json",success:function(t){e.createMedia(t)},error:function(t,i){var n="";n+="Unable to load Tweet. <br/>"+e.media_id+"<br/>"+i,e.loadErrorDisplay(n)}})},createMedia:function(t){trace("create_media");var e="",i="",n="",a="",s="",o="";i=t.html.split("</p>&mdash;")[0]+"</p></blockquote>",n=t.author_url.split("twitter.com/")[1],a=t.html.split("</p>&mdash;")[1].split('<a href="')[1],s=a.split('">')[0],o=a.split('">')[1].split("</a>")[0],e+=i,e+="<div class='vcard'>",e+="<a href='"+s+"' class='twitter-date' target='_blank'>"+o+"</a>",e+="<div class='author'>",e+="<a class='screen-name url' href='"+t.author_url+"' target='_blank'>",e+="<span class='avatar'></span>",e+="<span class='fn'>"+t.author_name+" <span class='vco-icon-twitter'></span></span>",e+="<span class='nickname'>@"+n+"<span class='thumbnail-inline'></span></span>",e+="</a>",e+="</div>",e+="</div>",this._el.content_item.innerHTML=e,this.onLoaded()},updateMediaDisplay:function(){},_updateMediaDisplay:function(){}}),VCO.Media.Vimeo=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe vco-media-vimeo vco-media-shadow",this._el.content),this.media_id=this.data.url.split(/video\/|\/\/vimeo\.com\//)[1].split(/[?&]/)[0],t="http://player.vimeo.com/video/"+this.media_id+"?api=1&title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff",this.player=VCO.Dom.create("iframe","",this._el.content_item),this.player.addEventListener("load",function(t){e.onMediaLoaded()}),this.player.width="100%",this.player.height="100%",this.player.frameBorder="0",this.player.src=t,this.onLoaded()},_updateMediaDisplay:function(){this._el.content_item.style.height=VCO.Util.ratio.r16_9({w:this._el.content_item.offsetWidth})+"px"},_stopMedia:function(){try{this.player.contentWindow.postMessage(JSON.stringify({method:"pause"}),"http://player.vimeo.com")}catch(t){trace(t)}}}),VCO.Media.DailyMotion=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe vco-media-dailymotion",this._el.content),this.media_id=this.data.url.match("video")?this.data.url.split("video/")[1].split(/[?&]/)[0]:this.data.url.split("embed/")[1].split(/[?&]/)[0],t="http://www.dailymotion.com/embed/video/"+this.media_id,this._el.content_item.innerHTML="<iframe autostart='false' frameborder='0' width='100%' height='100%' src='"+t+"'></iframe>",this.onLoaded()},_updateMediaDisplay:function(){this._el.content_item.style.height=VCO.Util.ratio.r16_9({w:this._el.content_item.offsetWidth})+"px"}}),VCO.Media.Vine=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe vco-media-vine vco-media-shadow",this._el.content),this.media_id=this.data.url.split("vine.co/v/")[1],t="https://vine.co/v/"+this.media_id+"/embed/simple",this._el.content_item.innerHTML="<iframe frameborder='0' width='100%' height='100%' src='"+t+"'></iframe><script async src='http://platform.vine.co/static/scripts/embed.js' charset='utf-8'></script>",this.onLoaded()},_updateMediaDisplay:function(){var t=VCO.Util.ratio.square({w:this._el.content_item.offsetWidth,h:this.options.height});this._el.content_item.style.height=t.h+"px"}}),VCO.Media.Website=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-blockquote",this._el.content),this._el.content_container.className="vco-media-content-container vco-media-content-container-text",this.media_id=this.data.url,this._el.content_item.innerHTML="<a target='_blank' href='"+this.media_id+"'> "+this.media_id+"</a>",this.onLoaded()},updateMediaDisplay:function(){},_updateMediaDisplay:function(){}}),VCO.Media.Wikipedia=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e,i=this;
this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-wikipedia",this._el.content),this._el.content_container.className="vco-media-content-container vco-media-content-container-text",this.media_id=this.data.url.split("wiki/")[1].split("#")[0].replace("_"," "),this.media_id=this.media_id.replace(" ","%20"),e=this.data.url.split("//")[1].split(".wikipedia")[0],t="http://"+e+".wikipedia.org/w/api.php?action=query&prop=extracts&redirects=&titles="+this.media_id+"&exintro=1&format=json&callback=?",VCO.ajax({type:"GET",url:t,dataType:"json",success:function(t){i.createMedia(t)},error:function(t,e){var n="";n+="Unable to load Wikipedia entry. <br/>"+i.media_id+"<br/>"+e,i.loadErrorDisplay(n)}})},createMedia:function(t){var e="";if(t.query){var i,e={entry:{},title:"",text:"",extract:"",paragraphs:1,text_array:[]};e.entry=VCO.Util.getObjectAttributeByIndex(t.query.pages,0),e.extract=e.entry.extract,e.title=e.entry.title,e.extract.match("<p>")?e.text_array=e.extract.split("<p>"):e.text_array.push(e.extract);for(var n=0;n<e.text_array.length;n++)n+1<=e.paragraphs&&n+1<e.text_array.length&&(e.text+="<p>"+e.text_array[n+1]);i="<h4><a href='"+this.data.url+"' target='_blank'>"+e.title+"</a></h4>",i+="<span class='wiki-source'>"+this._("wikipedia")+"</span>",i+=e.text,e.extract.match("REDIRECT")||(this._el.content_item.innerHTML=i,this.onLoaded())}},updateMediaDisplay:function(){},_updateMediaDisplay:function(){}}),VCO.Media.YouTube=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t=this,e;this.loadingMessage(),this.youtube_loaded=!1,this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-youtube vco-media-shadow",this._el.content),this._el.content_item.id=VCO.Util.unique_ID(7),e=VCO.Util.getUrlVars(this.data.url),this.media_id={},this.data.url.match("v=")?this.media_id.id=e.v:this.data.url.match("/embed/")?this.media_id.id=this.data.url.split("embed/")[1].split(/[?&]/)[0]:this.data.url.match(/v\/|v=|youtu\.be\//)?this.media_id.id=this.data.url.split(/v\/|v=|youtu\.be\//)[1].split(/[?&]/)[0]:trace("YOUTUBE IN URL BUT NOT A VALID VIDEO"),this.media_id.start=e.t,this.media_id.hd=e.hd,VCO.Load.js("https://www.youtube.com/player_api",function(){t.createMedia()})},_updateMediaDisplay:function(){this._el.content_item.style.height=VCO.Util.ratio.r16_9({w:this.options.width})+"px",this._el.content_item.style.width=this.options.width+"px"},_stopMedia:function(){if(this.youtube_loaded)try{this.player.pauseVideo()}catch(t){trace(t)}},createMedia:function(){var t=this;if("undefined"!=typeof this.media_id.start){var e=this.media_id.start.toString(),i=0,n=0;e.match("m")?(i=parseInt(e.split("m")[0],10),n=parseInt(e.split("m")[1].split("s")[0],10),this.media_id.start=60*i+n):this.media_id.start=0}else this.media_id.start=0;this.media_id.hd="undefined"!=typeof this.media_id.hd?!0:!1,this.createPlayer()},createPlayer:function(){var t=this;clearTimeout(this.timer),"undefined"!=typeof YT&&"undefined"!=typeof YT.Player?this.player=new YT.Player(this._el.content_item.id,{playerVars:{enablejsapi:1,color:"white",autohide:1,showinfo:0,theme:"light",start:this.media_id.start,fs:0,rel:0},videoId:this.media_id.id,events:{onReady:function(){t.onPlayerReady(),t.onLoaded()},onStateChange:t.onStateChange}}):this.timer=setTimeout(function(){t.createPlayer()},1e3)},onPlayerReady:function(t){this.youtube_loaded=!0,this._el.content_item=document.getElementById(this._el.content_item.id),this.onMediaLoaded()},onStateChange:function(t){}}),VCO.Media.Slider=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){this._el.content_item=VCO.Dom.create("img","vco-media-item vco-media-image",this._el.content),this._el.content_item.src=this.data.url,this.onLoaded()}}),VCO.Media.Spotify=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;if(this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe vco-media-spotify",this._el.content),this.data.url.match("open.spotify.com/track/"))this.media_id="spotify:track:"+this.data.url.split("open.spotify.com/track/")[1];else if(this.data.url.match("spotify:track:"))this.media_id=this.data.url;else if(this.data.url.match("/playlist/")){var i=this.data.url.split("open.spotify.com/user/")[1].split("/playlist/")[0];this.media_id="spotify:user:"+i+":playlist:"+this.data.url.split("/playlist/")[1]}else this.data.url.match(":playlist:")&&(this.media_id=this.data.url);t="http://embed.spotify.com/?uri="+this.media_id+"&theme=white&view=coverart",this.player=VCO.Dom.create("iframe","vco-media-shadow",this._el.content_item),this.player.width="100%",this.player.height="100%",this.player.frameBorder="0",this.player.src=t,this.onLoaded()},_updateMediaDisplay:function(t){var e=this.options.height,i=0,n=0;e=VCO.Browser.mobile?this.options.height/2:this.options.height-this.options.credit_height-this.options.caption_height-30,this._el.content_item.style.maxHeight="none",trace(e),trace(this.options.width),e>this.options.width?(trace("height is greater"),i=this.options.width+80+"px",n=this.options.width+"px"):(trace("width is greater"),trace(this.options.width),i=e+"px",n=e-80+"px"),this.player.style.width=n,this.player.style.height=i,this._el.credit&&(this._el.credit.style.width=n),this._el.caption&&(this._el.caption.style.width=n)},_stopMedia:function(){}}),VCO.Slide=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins,VCO.I18NMixins],_el:{},initialize:function(t,e,i){this._el={container:{},scroll_container:{},background:{},content_container:{},content:{}},this._media=null,this._mediaclass={},this._text={},this._state={loaded:!1},this.has={headline:!1,text:!1,media:!1,title:!1,background:{image:!1,color:!1,color_value:""}},this.has.title=i,this.data={uniqueid:null,background:null,start_date:null,end_date:null,location:null,text:null,media:null},this.options={duration:1e3,slide_padding_lr:40,ease:VCO.Ease.easeInSpline,width:600,height:600,skinny_size:650,media_name:""},this.active=!1,this.animator={},VCO.Util.mergeData(this.options,e),VCO.Util.mergeData(this.data,t),this._initLayout(),this._initEvents()},show:function(){this.animator=VCO.Animate(this._el.slider_container,{left:-(this._el.container.offsetWidth*n)+"px",duration:this.options.duration,easing:this.options.ease})},hide:function(){},setActive:function(t){this.active=t,this.active?(this.data.background&&this.fire("background_change",this.has.background),this.loadMedia()):this.stopMedia()},addTo:function(t){t.appendChild(this._el.container)},removeFrom:function(t){t.removeChild(this._el.container)},updateDisplay:function(t,e,i){this._updateDisplay(t,e,i)},loadMedia:function(){this._media&&!this._state.loaded&&(this._media.loadMedia(),this._state.loaded=!0)},stopMedia:function(){this._media&&this._state.loaded&&this._media.stopMedia()},getBackground:function(){return this.has.background},scrollToTop:function(){this._el.container.scrollTop=0},_initLayout:function(){var t="";this._el.container=VCO.Dom.create("div","vco-slide"),this.data.uniqueid&&(this._el.container.id=this.data.uniqueid),this._el.scroll_container=VCO.Dom.create("div","vco-slide-scrollable-container",this._el.container),this._el.content_container=VCO.Dom.create("div","vco-slide-content-container",this._el.scroll_container),this._el.content=VCO.Dom.create("div","vco-slide-content",this._el.content_container),this._el.background=VCO.Dom.create("div","vco-slide-background",this._el.container),this.data.background&&(this.data.background.url&&(this.has.background.image=!0,this._el.container.className+=" vco-full-image-background",this.has.background.color_value="#000",this._el.background.style.backgroundImage="url('"+this.data.background.url+"')",this._el.background.style.display="block"),this.data.background.color&&(this.has.background.color=!0,this._el.container.className+=" vco-full-color-background",this.has.background.color_value=this.data.background.color),this.data.background.text_background&&(this._el.container.className+=" vco-text-background")),this.data.media&&this.data.media.url&&""!=this.data.media.url&&(this.has.media=!0),this.data.text&&this.data.text.text&&(this.has.text=!0),this.data.text&&this.data.text.headline&&(this.has.headline=!0),this.has.media&&(this.data.media.mediatype=VCO.MediaType(this.data.media),this.options.media_name=this.data.media.mediatype.name,this.options.media_type=this.data.media.mediatype.type,this._media=new this.data.media.mediatype.cls(this.data.media,this.options)),(this.has.text||this.has.headline)&&(this._text=new VCO.Media.Text(this.data.text,{title:this.has.title,language:this.options.language}),this.data.end_date&&(t=" &mdash; "+this.data.end_date.getDisplayDate(this.getLanguage())),this.data.start_date&&(t=this.data.start_date.getDisplayDate(this.getLanguage())+t,this._text.addDateText(t))),this.has.text||this.has.headline||!this.has.media?this.has.headline&&this.has.media&&!this.has.text?(this._el.container.className+=" vco-slide-media-only",this._text.addTo(this._el.content),this._media.addTo(this._el.content)):this.has.text&&this.has.media?(this._media.addTo(this._el.content),this._text.addTo(this._el.content)):(this.has.text||this.has.headline)&&(this._el.container.className+=" vco-slide-text-only",this._text.addTo(this._el.content)):(this._el.container.className+=" vco-slide-media-only",this._media.addTo(this._el.content)),this.onLoaded()},_initEvents:function(){},_updateDisplay:function(t,e,i){var n,a=this.options.slide_padding_lr,s=this.options.slide_padding_lr;this.options.width=t?t:this._el.container.offsetWidth,n=this.options.width-2*this.options.slide_padding_lr,VCO.Browser.mobile&&this.options.width<=this.options.skinny_size?(a=0,s=0,n=this.options.width):"landscape"==i||this.options.width<=this.options.skinny_size,this._el.content.style.paddingLeft=a+"px",this._el.content.style.paddingRight=s+"px",this._el.content.style.width=n+"px",this.options.height=e?e:this._el.container.offsetHeight,this._media&&(!this.has.text&&this.has.headline?this._media.updateDisplay(n,this.options.height-this._text.headlineHeight(),i):this.has.text||this.has.headline?this._media.updateDisplay(n/2,this.options.height,i):this._media.updateDisplay(n,this.options.height,i))}}),VCO.SlideNav=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins],_el:{},initialize:function(t,e,i){this._el={container:{},content_container:{},icon:{},title:{},description:{}},this.mediatype={},this.data={title:"Navigation",description:"Description"},this.options={direction:"previous"},this.animator=null,VCO.Util.mergeData(this.options,e),VCO.Util.mergeData(this.data,t),this._el.container=VCO.Dom.create("div","vco-slidenav-"+this.options.direction),VCO.Browser.mobile&&this._el.container.setAttribute("ontouchstart"," "),this._initLayout(),this._initEvents(),i&&i.appendChild(this._el.container)},update:function(t){this._update(t)},setColor:function(t){this._el.content_container.className=t?"vco-slidenav-content-container vco-slidenav-inverted":"vco-slidenav-content-container"},_onMouseClick:function(){this.fire("clicked",this.options)},_update:function(t){this.data=VCO.Util.mergeData(this.data,t),""!=this.data.title&&(this._el.title.innerHTML=VCO.Util.unlinkify(this.data.title)),""!=this.data.date&&(this._el.description.innerHTML=VCO.Util.unlinkify(this.data.description))},_initLayout:function(){this._el.content_container=VCO.Dom.create("div","vco-slidenav-content-container",this._el.container),this._el.icon=VCO.Dom.create("div","vco-slidenav-icon",this._el.content_container),this._el.title=VCO.Dom.create("div","vco-slidenav-title",this._el.content_container),this._el.description=VCO.Dom.create("div","vco-slidenav-description",this._el.content_container),this._el.icon.innerHTML="&nbsp;",this._update()},_initEvents:function(){VCO.DomEvent.addListener(this._el.container,"click",this._onMouseClick,this)}}),VCO.StorySlider=VCO.Class.extend({includes:VCO.Events,initialize:function(t,e,i,n){this._el={container:{},background:{},slider_container_mask:{},slider_container:{},slider_item_container:{}},this._nav={},this._nav.previous={},this._nav.next={},this.slide_spacing=0,this._slides=[],this._swipable,this.preloadTimer,this._message,this.current_slide=0,this.data={},this.options={id:"",layout:"portrait",width:600,height:600,default_bg_color:{r:256,g:256,b:256},slide_padding_lr:40,start_at_slide:1,slide_default_fade:"0%",duration:1e3,ease:VCO.Ease.easeInOutQuint,dragging:!0,trackResize:!0},"object"==typeof t?(this._el.container=t,this.options.id=VCO.Util.unique_ID(6,"vco")):(this.options.id=t,this._el.container=VCO.Dom.get(t)),this._el.container.id||(this._el.container.id=this.options.id),this.animator=null,VCO.Util.mergeData(this.options,i),VCO.Util.mergeData(this.data,e),n&&this.init()},init:function(){this._initLayout(),this._initEvents(),this._initData(),this._updateDisplay(),this.goTo(this.options.start_at_slide),this._onLoaded()},updateDisplay:function(t,e,i,n){this._updateDisplay(t,e,i,n)},createSlide:function(t){this._createSlide(t)},createSlides:function(t){this._createSlides(t)},_createSlides:function(t){for(var e=0;e<t.length;e++)""==t[e].uniqueid&&(t[e].uniqueid=VCO.Util.unique_ID(6,"vco-slide")),0==e?this._createSlide(t[e],!0):this._createSlide(t[e],!1)},_createSlide:function(t,e){var i=new VCO.Slide(t,this.options,e);this._addSlide(i),this._slides.push(i)},_destroySlide:function(t){this._removeSlide(t);for(var e=0;e<this._slides.length;e++)this._slides[e]==t&&this._slides.splice(e,1)},_addSlide:function(t){t.addTo(this._el.slider_item_container),t.on("added",this._onSlideAdded,this),t.on("background_change",this._onBackgroundChange,this)},_removeSlide:function(t){t.removeFrom(this._el.slider_item_container),t.off("added",this._onSlideAdded,this),t.off("background_change",this._onBackgroundChange)},goToId:function(t,e,i){_n="string"==typeof t||t instanceof String?VCO.Util.findArrayNumberByUniqueID(t,this._slides,"uniqueid"):t,this.goTo(_n,e,i)},goTo:function(t,e,i){var n=this;this.changeBackground({color_value:"",image:!1}),this.preloadTimer&&clearTimeout(this.preloadTimer);for(var a=0;a<this._slides.length;a++)this._slides[a].setActive(!1);t<this._slides.length&&t>=0&&(this.current_slide=t,this.animator&&this.animator.stop(),this._swipable&&this._swipable.stopMomentum(),e?(this._el.slider_container.style.left=-(this.slide_spacing*t)+"px",this._onSlideChange(i)):this.animator=VCO.Animate(this._el.slider_container,{left:-(this.slide_spacing*t)+"px",duration:this.options.duration,easing:this.options.ease,complete:this._onSlideChange(i)}),this._slides[this.current_slide].setActive(!0),this._slides[this.current_slide+1]?(this.showNav(this._nav.next,!0),this._nav.next.update(this.getNavInfo(this._slides[this.current_slide+1]))):this.showNav(this._nav.next,!1),this._slides[this.current_slide-1]?(this.showNav(this._nav.previous,!0),this._nav.previous.update(this.getNavInfo(this._slides[this.current_slide-1]))):this.showNav(this._nav.previous,!1),this.preloadTimer=setTimeout(function(){n.preloadSlides()},this.options.duration))},preloadSlides:function(){this._slides[this.current_slide+1]&&(this._slides[this.current_slide+1].loadMedia(),this._slides[this.current_slide+1].scrollToTop()),this._slides[this.current_slide+2]&&(this._slides[this.current_slide+2].loadMedia(),this._slides[this.current_slide+2].scrollToTop()),this._slides[this.current_slide-1]&&(this._slides[this.current_slide-1].loadMedia(),this._slides[this.current_slide-1].scrollToTop()),this._slides[this.current_slide-2]&&(this._slides[this.current_slide-2].loadMedia(),this._slides[this.current_slide-2].scrollToTop())},getNavInfo:function(t){var e={title:"",description:""};return t.data.text&&t.data.text.headline&&(e.title=t.data.text.headline),e},next:function(){this.goTo(this.current_slide+1<this._slides.length?this.current_slide+1:this.current_slide)},previous:function(){this.goTo(this.current_slide-1>=0?this.current_slide-1:this.current_slide)},showNav:function(t,e){this.options.width<=500&&VCO.Browser.mobile||(e?t.show():t.hide())},changeBackground:function(t){var e={r:256,g:256,b:256},i,n=this.options.slide_default_fade,a="15%",s="0.87",o="";e=t.color_value?VCO.Util.hexToRgb(t.color_value):this.options.default_bg_color,i=e.r+","+e.g+","+e.b,this._el.background.style.backgroundImage="none",this._el.background.style.backgroundColor=t.color_value?t.color_value:"transparent",e.r<255&&e.g<255&&e.b<255||t.image?(this._nav.next.setColor(!0),this._nav.previous.setColor(!0)):(this._nav.next.setColor(!1),this._nav.previous.setColor(!1))},_updateDisplay:function(t,e,i,n){var a,s;s="undefined"==typeof n?this.options.layout:n,this.options.layout=s,this.slide_spacing=2*this.options.width,this.options.width=t?t:this._el.container.offsetWidth,this.options.height=e?e:this._el.container.offsetHeight,a=this.options.height/2,this._nav.next.setPosition({top:a}),this._nav.previous.setPosition({top:a});for(var o=0;o<this._slides.length;o++)this._slides[o].updateDisplay(this.options.width,this.options.height,s),this._slides[o].setPosition({left:this.slide_spacing*o,top:0});this.goTo(this.current_slide,!0,!0)},_initLayout:function(){this._el.container.className+=" vco-storyslider",this._el.slider_container_mask=VCO.Dom.create("div","vco-slider-container-mask",this._el.container),this._el.background=VCO.Dom.create("div","vco-slider-background vco-animate",this._el.container),this._el.slider_container=VCO.Dom.create("div","vco-slider-container vcoanimate",this._el.slider_container_mask),this._el.slider_item_container=VCO.Dom.create("div","vco-slider-item-container",this._el.slider_container),this.options.width=this._el.container.offsetWidth,this.options.height=this._el.container.offsetHeight,this._nav.previous=new VCO.SlideNav({title:"Previous",description:"description"},{direction:"previous"}),this._nav.next=new VCO.SlideNav({title:"Next",description:"description"},{direction:"next"}),this._nav.next.addTo(this._el.container),this._nav.previous.addTo(this._el.container),this._el.slider_container.style.left="0px",VCO.Browser.touch&&(this._swipable=new VCO.Swipable(this._el.slider_container_mask,this._el.slider_container,{enable:{x:!0,y:!1},snap:!0}),this._swipable.enable(),this._message=new VCO.Message({},{message_class:"vco-message-full",message_icon_class:"vco-icon-swipe-left"}),this._message.updateMessage("Swipe to Navigate<br><span class='vco-button'>OK</span>"),this._message.addTo(this._el.container))},_initEvents:function(){this._nav.next.on("clicked",this._onNavigation,this),this._nav.previous.on("clicked",this._onNavigation,this),this._message&&this._message.on("clicked",this._onMessageClick,this),this._swipable&&(this._swipable.on("swipe_left",this._onNavigation,this),this._swipable.on("swipe_right",this._onNavigation,this),this._swipable.on("swipe_nodirection",this._onSwipeNoDirection,this))},_initData:function(){this._createSlides(this.data.slides)},_onBackgroundChange:function(t){var e=this._slides[this.current_slide].getBackground();this.changeBackground(t),this.fire("colorchange",e)},_onMessageClick:function(t){this._message.hide()},_onSwipeNoDirection:function(t){this.goTo(this.current_slide)},_onNavigation:function(t){"next"==t.direction||"left"==t.direction?this.next():("previous"==t.direction||"right"==t.direction)&&this.previous(),this.fire("nav_"+t.direction,this.data)},_onSlideAdded:function(t){trace("slideadded"),this.fire("slideAdded",this.data)},_onSlideRemoved:function(t){this.fire("slideAdded",this.data)},_onSlideChange:function(t){t||this.fire("change",{current_slide:this.current_slide,uniqueid:this._slides[this.current_slide].data.uniqueid})},_onMouseClick:function(t){},_fireMouseEvent:function(t){if(this._loaded){var e=t.type;e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)&&("contextmenu"===e&&VCO.DomEvent.preventDefault(t),this.fire(e,{latlng:"something",layerPoint:"something else"}))}},_onLoaded:function(){this.fire("loaded",this.data)}}),VCO.TimeNav=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins],_el:{},initialize:function(t,e,i,n){this._el={parent:{},container:{},slider:{},slider_background:{},line:{},marker_container_mask:{},marker_container:{},marker_item_container:{},timeaxis:{},timeaxis_background:{}},this.collapsed=!1,this._el.container="object"==typeof t?t:VCO.Dom.get(t),this.data={uniqueid:"",slides:[{uniqueid:"",background:{url:null,color:null,opacity:50},date:null,location:{lat:-9.143962,lon:38.731094,zoom:13,icon:"http://maps.gstatic.com/intl/en_us/mapfiles/ms/micons/blue-pushpin.png"},text:{headline:"Slideshow Example",text:"Example slideshow slide "},media:[{uniqueid:"",text:{headline:"Slideshow Example",text:""},media:{url:"http://2.bp.blogspot.com/-dxJbW0CG8Zs/TmkoMA5-cPI/AAAAAAAAAqw/fQpsz9GpFdo/s1600/voyage-dans-la-lune-1902-02-g.jpg",credit:"",caption:"",link:null,link_target:null}},{uniqueid:"",text:{headline:"Slideshow Example",text:""},media:{url:"http://2.bp.blogspot.com/-dxJbW0CG8Zs/TmkoMA5-cPI/AAAAAAAAAqw/fQpsz9GpFdo/s1600/voyage-dans-la-lune-1902-02-g.jpg",credit:"",caption:"",link:null,link_target:null}},{uniqueid:"",text:{headline:"Slideshow Example",text:""},media:{url:"http://2.bp.blogspot.com/-dxJbW0CG8Zs/TmkoMA5-cPI/AAAAAAAAAqw/fQpsz9GpFdo/s1600/voyage-dans-la-lune-1902-02-g.jpg",credit:"",caption:"",link:null,link_target:null}},{uniqueid:"",text:{headline:"Slideshow Example",text:""},media:{url:"http://2.bp.blogspot.com/-dxJbW0CG8Zs/TmkoMA5-cPI/AAAAAAAAAqw/fQpsz9GpFdo/s1600/voyage-dans-la-lune-1902-02-g.jpg",credit:"",caption:"",link:null,link_target:null}}]},{uniqueid:"",background:{url:null,color:null,opacity:50},date:null,location:{lat:-9.143962,lon:38.731094,zoom:13,icon:"http://maps.gstatic.com/intl/en_us/mapfiles/ms/micons/blue-pushpin.png"},text:{headline:"YouTube",text:"Just add a link to the video in the media field."},media:{url:"http://www.youtube.com/watch?v=lIvftGgps24",credit:"",caption:"",link:null,link_target:null}}]},this.options={width:600,height:600,duration:1e3,ease:VCO.Ease.easeInOutQuint,optimal_tick_width:50,scale_factor:2,marker_padding:5,timenav_height_min:150,marker_height_min:30,marker_width_min:100,zoom_sequence:[.5,1,2,3,5,8,13,21,34,55,89]},this.animator=null,this._markers=[],this._marker_ticks=[],this.current_marker=0,this.current_id="",this.timescale={},this.timeaxis={},this.axishelper={},this.max_rows=6,this.animate_css=!1,this._swipable,VCO.Util.mergeData(this.options,i),VCO.Util.mergeData(this.data,e),n&&this.init()},init:function(){this._initLayout(),this._initEvents(),this._initData(),this._updateDisplay(),this._onLoaded()},positionMarkers:function(){this._positionMarkers()},updateDisplay:function(t,e,i,n){this._updateDisplay(t,e,i,n)},_getTimeScale:function(){return this.max_rows=Math.round((this.options.height-this._el.timeaxis_background.offsetHeight-this.options.marker_padding)/this.options.marker_height_min),this.max_rows<1&&(this.max_rows=1),new VCO.TimeScale(this.data.scale,this.data.slides,this._el.container.offsetWidth,this.options.scale_factor,this.max_rows)},_updateTimeScale:function(t){this.options.scale_factor=t,this._updateDrawTimeline()},zoomIn:function(t){for(var e=1,i=0;i<this.options.zoom_sequence.length;i++)this.options.scale_factor==this.options.zoom_sequence[i]&&(e=this.options.scale_factor==this.options.zoom_sequence[this.options.zoom_sequence.length-1]?this.options.scale_factor:this.options.zoom_sequence[i+1]);this.options.scale_factor=e,this.goTo(this.current_marker,!this._updateDrawTimeline(!0),!0)},zoomOut:function(t){if(this.options.scale_factor>0){for(var e=1,i=0;i<this.options.zoom_sequence.length;i++)this.options.scale_factor==this.options.zoom_sequence[i]&&(e=this.options.scale_factor==this.options.zoom_sequence[0]?this.options.zoom_sequence[0]:this.options.zoom_sequence[i-1]);this.options.scale_factor=e,this.goTo(this.current_marker,!this._updateDrawTimeline(!0),!0)}},_createMarkers:function(t){for(var e=0;e<t.length;e++)t[e].marker_number=e,this._createMarker(t[e])},_createMarker:function(t){var e=new VCO.TimeMarker(t,this.options);this._addMarker(e),this._markers.push(e),this._marker_ticks.push(e.getTime())},_addMarker:function(t){t.addTo(this._el.marker_item_container),t.on("markerclick",this._onMarkerClick,this),t.on("added",this._onMarkerAdded,this)},_removeMarker:function(t){t.removeFrom(this._el.marker_item_container)},_positionMarkers:function(t){for(var e=0;e<this._markers.length;e++){var i=this.timescale.getPositionInfo(e);this._markers[e].setClass(t?"vco-timemarker vco-timemarker-fast":"vco-timemarker"),this._markers[e].setPosition({left:i.start}),this._markers[e].setWidth(i.width)}},_assignRowsToMarkers:function(){for(var t=this.options.height-this._el.timeaxis_background.offsetHeight-this.options.marker_padding,e=Math.floor(t/this.timescale.getNumberOfRows()-this.options.marker_padding),i=0;i<this._markers.length;i++){this._markers[i].setHeight(e);var n=this.timescale.getPositionInfo(i).row,a=Math.floor(n*(e+this.options.marker_padding))+this.options.marker_padding,s=t-a+this.options.marker_padding;this._markers[i].setRowPosition(a,s)}},_resetMarkersActive:function(){for(var t=0;t<this._markers.length;t++)this._markers[t].setActive(!1)},goToId:function(t,e,i){_n="string"==typeof t||t instanceof String?VCO.Util.findArrayNumberByUniqueID(t,this._markers,"uniqueid"):t,this.goTo(_n,e,i)},goTo:function(t,e,i){var n=this,a=this.options.ease,s=this.options.duration;this._resetMarkersActive(),this._markers[t].setActive(!0),this.animator&&this.animator.stop(),e?(this._el.slider.className="vco-timenav-slider",this._el.slider.style.left=-this._markers[t].getLeft()+this.options.width/2+"px"):i?(this._el.slider.className="vco-timenav-slider vco-timenav-slider-animate",this.animate_css=!0,this._el.slider.style.left=-this._markers[t].getLeft()+this.options.width/2+"px"):(this._el.slider.className="vco-timenav-slider",this.animator=VCO.Animate(this._el.slider,{left:-this._markers[t].getLeft()+this.options.width/2+"px",duration:s,easing:a})),this.current_marker=t,this.current_id=this._markers[t].data.uniqueid},_onLoaded:function(){this.fire("loaded",this.data)},_onMarkerAdded:function(t){this.fire("dateAdded",this.data)},_onMarkerRemoved:function(t){this.fire("dateRemoved",this.data)},_onMarkerClick:function(t){this.goTo(t.marker_number),this.fire("change",{uniqueid:t.uniqueid})},_onMouseScroll:function(t){var e=0,i=0,n={right:-(this.timescale.getPixelWidth()-this.options.width/2),left:this.options.width/2};t||(t=window.event),t.originalEvent&&(t=t.originalEvent),"undefined"!=typeof t.wheelDeltaX&&(e=t.wheelDeltaY/6,e=Math.abs(t.wheelDeltaX)>Math.abs(t.wheelDeltaY)?t.wheelDeltaX/6:0),e&&(t.preventDefault&&t.preventDefault(),t.returnValue=!1),i=parseInt(this._el.slider.style.left.replace("px",""))+e,i>n.left?i=n.left:i<n.right&&(i=n.right),this.animate_css&&(this._el.slider.className="vco-timenav-slider",this.animate_css=!1),this._el.slider.style.left=i+"px"},_onDragMove:function(t){this.animate_css&&(this._el.slider.className="vco-timenav-slider",this.animate_css=!1)},_updateDisplay:function(t,e,i){t&&(this.options.width=t),e&&e!=this.options.height&&(this.options.height=e,this.timescale=this._getTimeScale()),this._assignRowsToMarkers(),this._el.slider_background.style.width=this.timescale.getPixelWidth()+this.options.width+"px",this._el.slider_background.style.left=-(this.options.width/2)+"px",this._el.slider.style.width=this.timescale.getPixelWidth()+this.options.width+"px",this._swipable.updateConstraint({top:!1,bottom:!1,left:this.options.width/2,right:-(this.timescale.getPixelWidth()-this.options.width/2)}),this.goTo(this.current_marker,!0)},_drawTimeline:function(t){this.timescale=this._getTimeScale(),this.timeaxis.drawTicks(this.timescale,this.options.optimal_tick_width,this._marker_ticks),this._positionMarkers(t),this._assignRowsToMarkers()},_updateDrawTimeline:function(t){var e=!1;if(t){var i=new VCO.TimeScale(this.data.scale,this.data.slides,this._el.container.offsetWidth,this.options.scale_factor,this._max_rows);this.timescale.getMajorScale()==i.getMajorScale()&&this.timescale.getMinorScale()==i.getMinorScale()&&(e=!0)}else e=!0;return e?(this.timescale=this._getTimeScale(),this.timeaxis.positionTicks(this.timescale,this.options.optimal_tick_width),this._positionMarkers(),this._assignRowsToMarkers(),this._updateDisplay()):this._drawTimeline(!0),e},_initLayout:function(){this._el.line=VCO.Dom.create("div","vco-timenav-line",this._el.container),this._el.slider=VCO.Dom.create("div","vco-timenav-slider",this._el.container),this._el.slider_background=VCO.Dom.create("div","vco-timenav-slider-background",this._el.slider),this._el.marker_container_mask=VCO.Dom.create("div","vco-timenav-container-mask",this._el.slider),this._el.marker_container=VCO.Dom.create("div","vco-timenav-container",this._el.marker_container_mask),this._el.marker_item_container=VCO.Dom.create("div","vco-timenav-item-container",this._el.marker_container),this._el.timeaxis=VCO.Dom.create("div","vco-timeaxis",this._el.slider),this._el.timeaxis_background=VCO.Dom.create("div","vco-timeaxis-background",this._el.container),this.timeaxis=new VCO.TimeAxis(this._el.timeaxis,this.options),this._swipable=new VCO.Swipable(this._el.slider_background,this._el.slider,{enable:{x:!0,y:!1},constraint:{top:!1,bottom:!1,left:this.options.width/2,right:!1},snap:!1}),this._swipable.enable()},_initEvents:function(){this._swipable.on("dragmove",this._onDragMove,this),VCO.DomEvent.addListener(this._el.container,"mousewheel",this._onMouseScroll,this),VCO.DomEvent.addListener(this._el.container,"DOMMouseScroll",this._onMouseScroll,this)},_initData:function(){this._createMarkers(this.data.slides),this._drawTimeline()}}),VCO.TimeMarker=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins],_el:{},initialize:function(t,e){this._el={container:{},content_container:{},media_container:{},timespan:{},line_left:{},line_right:{},content:{},text:{},media:{}},this._text={},this._state={loaded:!1},this.data={uniqueid:"",marker_number:0,background:null,date:{year:0,month:0,day:0,hour:0,minute:0,second:0,millisecond:0,thumbnail:"",format:""},text:{headline:"",text:""},media:null},this.options={duration:1e3,ease:VCO.Ease.easeInSpline,width:600,height:600,marker_width_min:100},this.active=!1,this.animator={},this.has_end_date=!1,VCO.Util.mergeData(this.options,e),VCO.Util.mergeData(this.data,t),this._initLayout(),this._initEvents()},show:function(){},hide:function(){},setActive:function(t){this.active=t,this._el.container.className=this.active&&this.has_end_date?"vco-timemarker vco-timemarker-with-end vco-timemarker-active":this.active?"vco-timemarker vco-timemarker-active":this.has_end_date?"vco-timemarker vco-timemarker-with-end":"vco-timemarker"},addTo:function(t){t.appendChild(this._el.container)},removeFrom:function(t){t.removeChild(this._el.container)},updateDisplay:function(t,e){this._updateDisplay(t,e)},loadMedia:function(){this._media&&!this._state.loaded&&(this._media.loadMedia(),this._state.loaded=!0)},stopMedia:function(){this._media&&this._state.loaded&&this._media.stopMedia()},getLeft:function(){return this._el.container.style.left.slice(0,-2)},getTime:function(){return this.data.start_date.getTime()},getEndTime:function(){return this.data.end_date?this.data.end_date.getTime():!1},setHeight:function(t){var e=12,i=1;this._el.content_container.style.height=t+"px",this._el.timespan_content.style.height=t+"px",this._el.content.className=30>=t?"vco-timemarker-content vco-timemarker-content-small":"vco-timemarker-content",VCO.Browser.webkit?(i=Math.floor(t/(e+2)),1>i&&(i=1),this._text.className="vco-headline",this._text.style.webkitLineClamp=i):(i=t/e,this._text.className=i>1?"vco-headline vco-headline-fadeout":"vco-headline",this._text.style.height=i*e+"px")},setWidth:function(t){this.data.end_date&&(this._el.container.style.width=t+"px",this._el.content_container.style.width=t>this.options.marker_width_min?t+"px":this.options.marker_width_min+"px")},setClass:function(t){this._el.container.className=t},setRowPosition:function(t,e){this.setPosition({top:t}),this._el.timespan.style.height=e+"px"
},_onMarkerClick:function(t){this.fire("markerclick",{marker_number:this.data.marker_number,uniqueid:this.data.uniqueid})},_initLayout:function(){if(this._el.container=VCO.Dom.create("div","vco-timemarker"),this.data.uniqueid&&(this._el.container.id=this.data.uniqueid+"-marker"),this.data.end_date&&(this.has_end_date=!0,this._el.container.className="vco-timemarker vco-timemarker-with-end"),this._el.timespan=VCO.Dom.create("div","vco-timemarker-timespan",this._el.container),this._el.timespan_content=VCO.Dom.create("div","vco-timemarker-timespan-content",this._el.timespan),this._el.content_container=VCO.Dom.create("div","vco-timemarker-content-container",this._el.container),this._el.content=VCO.Dom.create("div","vco-timemarker-content",this._el.content_container),this._el.line_left=VCO.Dom.create("div","vco-timemarker-line-left",this._el.timespan),this._el.line_right=VCO.Dom.create("div","vco-timemarker-line-right",this._el.timespan),this.data.media)if(this._el.media_container=VCO.Dom.create("div","vco-timemarker-media-container",this._el.content),this.data.media.thumb&&""!=this.data.media.thumb)this._el.media=VCO.Dom.create("img","vco-timemarker-media",this._el.media_container),this._el.media.src=this.data.media.thumb;else{var t=VCO.MediaType(this.data.media).type;this._el.media=VCO.Dom.create("span","vco-icon-"+t,this._el.media_container)}this._el.text=VCO.Dom.create("div","vco-timemarker-text",this._el.content),this._text=VCO.Dom.create("h2","vco-headline",this._el.text),this.data.text.headline&&""!=this.data.text.headline?this._text.innerHTML=VCO.Util.unlinkify(this.data.text.headline):this.data.text.text&&""!=this.data.text.text?this._text.innerHTML=VCO.Util.unlinkify(this.data.text.text):this.data.media.caption&&""!=this.data.media.caption&&(this._text.innerHTML=VCO.Util.unlinkify(this.data.media.caption)),this.onLoaded()},_initEvents:function(){VCO.DomEvent.addListener(this._el.container,"click",this._onMarkerClick,this)},_updateDisplay:function(t,e,i){t&&(this.options.width=t),e&&(this.options.height=e)}}),VCO.TimeScale=VCO.Class.extend({initialize:function(t,e,i,n,a){this._scale=t||"javascript",this._display_width=i||500,this._screen_multiplier=n||3,this._pixel_width=this._screen_multiplier*this._display_width,this._positions=[],this._pixels_per_milli=0,this._earliest=e[0].start_date.getTime(),this._latest=e[e.length-1].start_date.getTime(),this._span_in_millis=this._latest-this._earliest,this._average=this._span_in_millis/e.length,this._pixels_per_milli=this.getPixelWidth()/this._span_in_millis,this._axis_helper=VCO.AxisHelper.getBestHelper(this),this._scaled_padding=1/this.getPixelsPerTick()*(this._display_width/2),this._computePositionInfo(e,a)},getScale:function(){return this._scale},getNumberOfRows:function(){return this._number_of_rows},getPixelWidth:function(){return this._pixel_width},getPosition:function(t){return(t-this._earliest)*this._pixels_per_milli},getPositionInfo:function(t){return this._positions[t]},getPixelsPerTick:function(){return this._axis_helper.getPixelsPerTick(this._pixels_per_milli)},getTicks:function(){return{major:this._axis_helper.getMajorTicks(this),minor:this._axis_helper.getMinorTicks(this)}},getDateFromTime:function(t){if("javascript"==this._scale)return new VCO.Date(t);if("cosmological"==this._scale)return new VCO.BigDate(new VCO.BigYear(t));throw"Don't know how to get date from time for "+this._scale},getMajorScale:function(){return this._axis_helper.major.name},getMinorScale:function(){return this._axis_helper.minor.name},_computePositionInfo:function(t,e,i){i=i||100;for(var n=[],a=0;a<t.length;a++){var s={start:this.getPosition(t[a].start_date.getTime())};if(this._positions.push(s),"undefined"!=typeof t[a].end_date){var o=this.getPosition(t[a].end_date.getTime());s.width=o-s.start,s.end=s.width>i?s.start+s.width:s.start+i}else s.width=i,s.end=s.start+i}for(var a=0;a<this._positions.length;a++){for(var s=this._positions[a],r=[],h=0;h<n.length;h++)if(r.push(n[h].end-s.start),r[h]<=0){s.row=h,n[h]=s;break}if("undefined"==typeof s.row)if(!e||n.length<e)s.row=n.length,n.push(s);else{var l=Math.min.apply(null,r),c=r.indexOf(l);s.row=c,s.end>n[c].end&&(n[c]=s)}}this._number_of_rows=n.length}}),VCO.TimeAxis=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins,VCO.I18NMixins],_el:{},initialize:function(t,e){this._el={container:{},content_container:{},major:{},minor:{}},this._text={},this._state={loaded:!1},this.data={},this.options={duration:1e3,ease:VCO.Ease.easeInSpline,width:600,height:600},this.active=!1,this.animator={},this.axis_helper={},this.minor_ticks=[],this.major_ticks=[],this.dateformat_lookup={millisecond:1,second:"time_short",minute:"time_no_seconds_short",hour:"time_no_minutes_short",day:"full_short",month:"month_short",year:"year",decade:"year",century:"year",millennium:"year",age:"compact",epoch:"compact",era:"compact",eon:"compact",eon2:"compact"},this._el.container="object"==typeof t?t:VCO.Dom.get(t),VCO.Util.mergeData(this.options,e),this._initLayout(),this._initEvents()},show:function(){},hide:function(){},addTo:function(t){t.appendChild(this._el.container)},removeFrom:function(t){t.removeChild(this._el.container)},updateDisplay:function(t,e){this._updateDisplay(t,e)},getLeft:function(){return this._el.container.style.left.slice(0,-2)},drawTicks:function(t,e,i){var n=t.getTicks(),a={minor:{el:this._el.minor,dateformat:this.dateformat_lookup[n.minor.name],ts_ticks:n.minor.ticks,tick_elements:this.minor_ticks},major:{el:this._el.major,dateformat:this.dateformat_lookup[n.major.name],ts_ticks:n.major.ticks,tick_elements:this.major_ticks}};this._el.major.className="vco-timeaxis-major",this._el.minor.className="vco-timeaxis-minor",this._el.major.style.opacity=0,this._el.minor.style.opacity=0,this.major_ticks=this._createTickElements(n.major.ticks,this._el.major,this.dateformat_lookup[n.major.name]),this.minor_ticks=this._createTickElements(n.minor.ticks,this._el.minor,this.dateformat_lookup[n.minor.name],n.major.ticks),this.positionTicks(t,e,!0),this._el.major.className="vco-timeaxis-major vco-animate-opacity vco-timeaxis-animate-opacity",this._el.minor.className="vco-timeaxis-minor vco-animate-opacity vco-timeaxis-animate-opacity",this._el.major.style.opacity=1,this._el.minor.style.opacity=1},_createTickElements:function(t,e,i,n){e.innerHTML="";var a={};if(n)for(idx in n)a[n[idx].getTime()]=!0;for(var s=[],o=0;o<t.length;o++){var r=t[o];if(!(r.getTime()in a)){var h=VCO.Dom.create("div","vco-timeaxis-tick",e),l=VCO.Dom.create("span","vco-timeaxis-tick-text vco-animate-opacity",h);l.innerHTML=r.getDisplayDate(this.getLanguage(),i),s.push({tick:h,tick_text:l,display_text:r.getDisplayDate(this.getLanguage(),i),date:r})}}return s},positionTicks:function(t,e,i){i?(this._el.major.className="vco-timeaxis-major",this._el.minor.className="vco-timeaxis-minor"):(this._el.major.className="vco-timeaxis-major vco-timeaxis-animate",this._el.minor.className="vco-timeaxis-minor vco-timeaxis-animate"),this._positionTickArray(this.major_ticks,t,e),this._positionTickArray(this.minor_ticks,t,e)},_positionTickArray:function(t,e,i){if(t[1]&&t[0]){var n=e.getPosition(t[1].date.getMillisecond())-e.getPosition(t[0].date.getMillisecond()),a=1;i>n&&(a=Math.round(i/e.getPixelsPerTick()));for(var s=1,o=0;o<t.length;o++){var r=t[o];r.tick.style.left=e.getPosition(r.date.getMillisecond())+"px",r.tick_text.innerHTML=r.display_text,a>1?s>=a?(s=1,r.tick_text.style.opacity=1):(s++,r.tick_text.style.opacity=0):r.tick_text.style.opacity=1}}},_initLayout:function(){this._el.content_container=VCO.Dom.create("div","vco-timeaxis-content-container",this._el.container),this._el.major=VCO.Dom.create("div","vco-timeaxis-major",this._el.content_container),this._el.minor=VCO.Dom.create("div","vco-timeaxis-minor",this._el.content_container),this.onLoaded()},_initEvents:function(){},_updateDisplay:function(t,e,i){t&&(this.options.width=t),e&&(this.options.height=e)}}),VCO.AxisHelper=VCO.Class.extend({initialize:function(t){if(!t)throw"Axis helper must be configured with options";this.scale=t.scale,this.minor=t.minor,this.major=t.major},getPixelsPerTick:function(t){return t*this.minor.factor},getMajorTicks:function(t){return this._getTicks(t,this.major)},getMinorTicks:function(t){return this._getTicks(t,this.minor)},_getTicks:function(t,e){for(var i=t._scaled_padding*e.factor,n=t._earliest-i,a=t._latest+i,s=[],o=n;a>o;o+=e.factor)s.push(t.getDateFromTime(o).floor(e.name));return window.ticks=s,window.axis_helper=this,{name:e.name,ticks:s}}}),function(t){var e={},i=function(i,n){e[i]=[];for(var a=0;a<n.length-1;a++){var s=n[a],o=n[a+1];e[i].push(new t({scale:s[3],minor:{name:s[0],factor:s[1]},major:{name:o[0],factor:o[1]}}))}};i("javascript",VCO.Date.SCALES),i("cosmological",VCO.BigDate.SCALES),t.HELPERS=e,t.getBestHelper=function(t,i){"number"!=typeof i&&(i=100);var n=t.getScale(),a=e[n];if(!a)throw"No AxisHelper available for "+n;var s=null;for(var o in a){var r=a[o],h=r.getPixelsPerTick(t._pixels_per_milli);if(h>i){if(null==s)return r;var l=Math.abs(i-h),c=Math.abs(i-h);return c>l?r:s}s=r}return a[a.length-1]}}(VCO.AxisHelper),VCO.Timeline=VCO.Class.extend({includes:VCO.Events,initialize:function(t,e,i){var n=this;this.version="0.0.20",this.ready=!1,this._el={container:{},storyslider:{},timenav:{},menubar:{}},this._el.container="object"==typeof t?t:VCO.Dom.get(t),this._storyslider={},this._style_sheet=new VCO.StyleSheet,this._timenav={},this._menubar={},this._loaded={storyslider:!1,timenav:!1},this.config=null,this.options={script_path:"",height:this._el.container.offsetHeight,width:this._el.container.offsetWidth,theme_color:!1,hash_bookmark:!1,default_bg_color:{r:255,g:255,b:255},scale_factor:2,layout:"landscape",timenav_position:"bottom",optimal_tick_width:60,base_class:"",timenav_height:150,timenav_height_percentage:25,timenav_height_min:150,marker_height_min:30,marker_width_min:100,marker_padding:5,start_at_slide:0,menubar_height:0,skinny_size:650,relative_date:!1,use_bc:!1,duration:1e3,ease:VCO.Ease.easeInOutQuint,dragging:!0,trackResize:!0,map_type:"stamen:toner-lite",slide_padding_lr:100,slide_default_fade:"0%",zoom_sequence:[.5,1,2,3,5,8,13,21,34,55,89],api_key_flickr:"f2cc870b4d233dd0a5bfe73fd0d64ef0",language:"en"},this.current_slide=this.options.start_at_slide,this.animator_timenav=null,this.animator_storyslider=null,this.animator_menubar=null,VCO.Util.mergeData(this.options,i),this.options.relative_date?"undefined"!=typeof moment?n._loadLanguage(e):VCO.Load.js(this.options.script_path+"/library/moment.js",function(){n._loadLanguage(e),trace("LOAD MOMENTJS")}):n._loadLanguage(e),this.options.theme_color&&this._applyCustomColor(this.options.theme_color)},_loadLanguage:function(t){var e=this;this.options.language=new VCO.Language(this.options),this._initData(t)},goToId:function(t){this.current_id!=t&&(this.current_id=t,this._timenav.goToId(this.current_id),this._storyslider.goToId(this.current_id,!1,!0),this.fire("change",{uniqueid:this.current_id},this))},goTo:function(t){t!=this.current_slide&&(this.current_slide=t,this._timenav.goTo(this.current_slide),this._storyslider.goTo(this.current_slide))},updateDisplay:function(){this.ready&&this._updateDisplay()},_calculateTimeNavHeight:function(t,e){var i=0;return t?i=t:(this.options.timenav_height_percentage||e)&&(i=Math.round(e?this.options.height/100*e:this.options.height/100*this.options.timenav_height_percentage)),i<this.options.timenav_height_min&&(i=this.options.timenav_height_min),i-=2*this.options.marker_padding},_updateDisplay:function(t,e,i){var n=this.options.duration,a=this.options.base_class,s=0,o=this;i&&(n=i),this.options.width=this._el.container.offsetWidth,this.options.height=this._el.container.offsetHeight,this.options.layout=this.options.width<=this.options.skinny_size?"portrait":"landscape",VCO.Browser.touch&&(this.options.layout=VCO.Browser.orientation()),VCO.Browser.mobile?(a+=" vco-mobile",this.options.timenav_height=this._calculateTimeNavHeight(t,40)):this.options.timenav_height=this._calculateTimeNavHeight(t),"portrait"==this.options.layout?(a+=" vco-skinny",a+=" vco-layout-portrait"):a+=" vco-layout-landscape",this.options.storyslider_height=this.options.height-this.options.timenav_height,s=Math.round(this.options.storyslider_height+1+Math.ceil(this.options.timenav_height)/2-this._el.menubar.offsetHeight/2-17.5),e?(this._el.timenav.style.height=Math.ceil(this.options.timenav_height)+"px",this.animator_storyslider&&this.animator_storyslider.stop(),this.animator_storyslider=VCO.Animate(this._el.storyslider,{height:this.options.storyslider_height+"px",duration:n/2,easing:VCO.Ease.easeOutStrong}),this.animator_menubar&&this.animator_menubar.stop(),this.animator_menubar=VCO.Animate(this._el.menubar,{top:s+"px",duration:n/2,easing:VCO.Ease.easeOutStrong})):(this._el.timenav.style.height=Math.ceil(this.options.timenav_height)+"px",this._el.storyslider.style.height=this.options.storyslider_height+"px",this._el.menubar.style.top=s+"px"),this._timenav.updateDisplay(this.options.width,this.options.timenav_height,e),this._storyslider.updateDisplay(this.options.width,this.options.storyslider_height,e,this.options.layout),this._el.container.className=a},_updateHashBookmark:function(t){window.location.hash="#event-"+t.toString(),this.fire("hash_updated",{uniqueid:this.current_id,hashbookmark:"#event-"+t.toString()},this)},_applyCustomColor:function(t){var e=VCO.Util.hexToRgb(t),i=".vco-timemarker.vco-timemarker-active .vco-timemarker-content-container,";i+=".vco-timemarker.vco-timemarker-active .vco-timemarker-timespan .vco-timemarker-timespan-content,",i+=".vco-timemarker.vco-timemarker-with-end.vco-timemarker-active .vco-timemarker-line-left:after,",i+=".vco-timemarker.vco-timemarker-with-end.vco-timemarker-active .vco-timemarker-line-right:after,",i+=".vco-timemarker.vco-timemarker-active .vco-timemarker-line-left:after,",i+=".vco-timemarker.vco-timemarker-active .vco-timemarker-line-right:after,",i+=".vco-menubar-button:hover",this._style_sheet.addRule(i,"background-color:"+t+" !important;"),this._style_sheet.addRule(".vco-timemarker.vco-timemarker-active .vco-timemarker-timespan","background-color:rgba("+e.r+","+e.g+","+e.b+",.15) !important;"),this._style_sheet.addRule(".vco-timemarker.vco-timemarker-with-end.vco-timemarker-active .vco-timemarker-timespan:after","background-color:rgba("+e.r+","+e.g+","+e.b+",.5) !important;"),this._style_sheet.addRule(".vco-timemarker.vco-timemarker-active .vco-timemarker-line-left, .vco-timemarker.vco-timemarker-active .vco-timemarker-line-right","border-color:"+t+" !important;"),this._style_sheet.addRule('.vco-timemarker.vco-timemarker-active .vco-timemarker-content-container .vco-timemarker-content .vco-timemarker-media-container [class^=vco-icon-], .vco-timemarker.vco-timemarker-active .vco-timemarker-content-container .vco-timemarker-content .vco-timemarker-media-container [class*=" vco-icon-"]',"color:rgba(255,255,255,.7) !important;"),this._style_sheet.addRule(".vco-timemarker.vco-timemarker-active .vco-timemarker-content-container .vco-timemarker-content .vco-timemarker-text h2.vco-headline.vco-headline-fadeout:after"," background: linear-gradient(to bottom, rgba("+e.r+","+e.g+","+e.b+",.15) 0px, "+t+" 80%) repeat scroll 0% 0% transparent !important;")},_initData:function(t){var e=this;VCO.TimelineConfig==t.constructor?(e.config=t,e._onDataLoaded()):e.config=new VCO.TimelineConfig(t,function(){e._onDataLoaded()})},_initLayout:function(){var t=this;this._el.container.className+=" vco-timeline",this.options.base_class=this._el.container.className,this._el.container.innerHTML="","top"==this.options.timenav_position?(this._el.timenav=VCO.Dom.create("div","vco-timenav",this._el.container),this._el.storyslider=VCO.Dom.create("div","vco-storyslider",this._el.container)):(this._el.storyslider=VCO.Dom.create("div","vco-storyslider",this._el.container),this._el.timenav=VCO.Dom.create("div","vco-timenav",this._el.container)),this._el.menubar=VCO.Dom.create("div","vco-menubar",this._el.container),this.options.width=this._el.container.offsetWidth,this.options.height=this._el.container.offsetHeight,this._el.storyslider.style.top="1px",this.options.timenav_height=this._calculateTimeNavHeight(),this._timenav=new VCO.TimeNav(this._el.timenav,this.config,this.options),this._timenav.on("loaded",this._onTimeNavLoaded,this),this._timenav.options.height=this.options.timenav_height,this._timenav.init(),this._storyslider=new VCO.StorySlider(this._el.storyslider,this.config,this.options),this._storyslider.on("loaded",this._onStorySliderLoaded,this),this._storyslider.init(),this._menubar=new VCO.MenuBar(this._el.menubar,this._el.container,this.options),this.options.storyslider_height="portrait"==this.options.layout?this.options.height-this.options.timenav_height-1:this.options.height-1,this._updateDisplay(!1,!0,2e3)},_initEvents:function(){this._timenav.on("change",this._onTimeNavChange,this),this._storyslider.on("change",this._onSlideChange,this),this._storyslider.on("colorchange",this._onColorChange,this),this._menubar.on("zoom_in",this._onZoomIn,this),this._menubar.on("zoom_out",this._onZoomOut,this),this._menubar.on("back_to_start",this._onBackToStart,this)},_getCurrentSlide:function(t,e){return _n="string"==typeof t||t instanceof String?VCO.Util.findArrayNumberByUniqueID(t,e,"uniqueid"):t},_onDataLoaded:function(t){this.fire("dataloaded"),this._initLayout(),this._initEvents(),this.ready=!0},_onColorChange:function(t){this.fire("color_change",{uniqueid:this.current_id},this),t.color||t.image},_onSlideChange:function(t){this.current_id!=t.uniqueid&&(this.current_id=t.uniqueid,this._timenav.goToId(this.current_id),this._onChange(t))},_onTimeNavChange:function(t){this.current_id!=t.uniqueid&&(this.current_id=t.uniqueid,this._storyslider.goToId(this.current_id),this._onChange(t))},_onChange:function(t){this.fire("change",{uniqueid:this.current_id},this),this.options.hash_bookmark&&this._updateHashBookmark(this.current_id)},_onBackToStart:function(t){this._storyslider.goTo(0),this.fire("back_to_start",{uniqueid:this.current_id},this)},_onZoomIn:function(t){this._timenav.zoomIn(),this.fire("zoom_in",{zoom_level:this._timenav.options.scale_factor},this)},_onZoomOut:function(t){this._timenav.zoomOut(),this.fire("zoom_out",{zoom_level:this._timenav.options.scale_factor},this)},_onTimeNavLoaded:function(){this._loaded.timenav=!0,this._onLoaded()},_onStorySliderLoaded:function(){this._loaded.storyslider=!0,this._onLoaded()},_onLoaded:function(){this._loaded.storyslider&&this._loaded.timenav&&(this.fire("loaded",this.config),this.options.hash_bookmark&&""!=window.location.hash?this.goToId(window.location.hash.replace("#event-","")):(this.goTo(this.options.start_at_slide),this.current_id=this._timenav.current_id,this.options.hash_bookmark&&this._updateHashBookmark(this.current_id)))}});